{"version":3,"sources":["store/user/types.ts","services/captcha.ts","store/user/actions.ts","store/user/StorageToken.ts","api/config.ts","services/http.ts","api/index.ts","store/login/actions.ts","components/AnimationElement/AnimationElement.tsx","components/Layouts/SideBar.tsx","store/regions/item/actions.ts","store/regions/list/actions.ts","components/Layouts/hooks/hookRegionDropdown.ts","components/Layouts/RegionsDropdown.tsx","components/Layouts/hooks/hookUserDropdown.ts","components/Layouts/UserDropdown.tsx","components/Layouts/Menu.tsx","components/Layouts/Content.tsx","components/Pages/Home/Home.tsx","store/events/public/list/actions.ts","components/UI/Pagination/Pagination.tsx","services/moment.ts","store/events/types.ts","store/events/profile/rules.ts","store/events/public/detail/types.ts","components/Pages/Profile/Events/hooks/hookEventItem.ts","components/Pages/Events/List/Item.tsx","components/Pages/Events/List/hooks/hookEventItem.ts","components/Pages/Events/List/List.tsx","components/Pages/Events/List/hooks/hookEventList.ts","components/Pages/Events/List/EventList.tsx","components/Pages/AboutUs/AboutUs.tsx","components/Pages/Profile/Events/List/EventItem.tsx","components/Pages/Profile/Events/List/EventList.tsx","components/Pages/Profile/Events/List/EventFilterForm.tsx","components/Pages/Profile/Events/hooks/hookEventFormSearch.ts","store/events/profile/list/actions.ts","components/Pages/Profile/Events/ProfileEvents.tsx","components/Pages/Profile/Events/hooks/hookEventList.ts","components/Pages/Profile/Profile.tsx","regex/index.ts","components/Auth/Login/hooks/hookLoginForm.ts","components/Auth/Login/LoginForm.tsx","components/Auth/Login/Login.tsx","components/Auth/Login/hooks/hookLoginModal.ts","store/events/public/detail/actions.ts","components/Pages/Events/Detail/hooks/hookEventDetail.ts","components/Map/Leaflet/Leaflet.tsx","services/coords/coords.ts","components/Map/constants.ts","components/Map/websocket.ts","services/socket-io.ts","components/Map/hookMap.ts","components/Map/LeafletMap.tsx","store/eventStatistic/actions.ts","components/Pages/Events/Detail/Finished/hooks/hookEventChart.ts","components/Pages/Events/Detail/Finished/EventChart.tsx","components/Pages/Events/Detail/EventDetailWrapper.tsx","components/Pages/Events/Detail/Waiting/EventWaiting.tsx","components/Pages/Events/Detail/Starting/EventStarting.tsx","components/Pages/Events/Detail/Finished/EventFinished.tsx","components/Pages/Events/Detail/hooks/hookEventDetailStatus.ts","components/Pages/Events/Detail/EventDetail.tsx","App.tsx","store/regions/list/reducer.ts","store/regions/item/reducer.ts","store/user/reducer.ts","store/login/reducer.ts","store/eventStatistic/reducer.ts","store/events/profile/list/reducer.ts","store/events/public/list/reducer.ts","store/events/public/detail/reducer.ts","store/rootReducer.ts","store/middleware.ts","store/store.ts","serviceWorker.ts","index.tsx"],"names":["Roles","UserResponseStatuses","captchaToken","action","a","load","String","process","captcha","execute","setUser","createAction","clearUser","StorageToken","tokenKey","userKey","expiredKey","token","userId","expired","localStorage","setItem","this","getItem","expiredAt","getExpiredAt","Date","getTime","removeItem","authHeaders","Authorization","api","region","list","http","get","config","then","response","data","auth","login","credentials","post","checkToken","headers","profile","events","page","form","public","detail","id","stat","eventId","setLoader","setError","setSuccess","showModal","hideModal","AnimationElement","children","nameEvent","delay","interval","iterations","elementRef","createRef","element","React","cloneElement","ref","useEffect","current","timer","el","i","classList","add","setTimeout","setInterval","remove","clearInterval","SideBar","useState","isSidebar","toggleSidebar","handleToggleSidebar","prev","className","type","onClick","icon","faBars","to","Nav","Link","as","NavLink","exact","Button","variant","setRegionAsync","dispatch","slug","setList","useRegionDropdown","useDispatch","useSelector","state","regions","regionSelected","length","find","item","handleChangeRegion","regionItem","RegionsDropdown","NavDropdown","title","label","map","Item","key","useUserDropdown","loaderLoginForm","loader","user","handlerLogout","clear","handleShowModal","UserDropdown","drop","name","disabled","Menu","Navbar","expand","Content","Home","setToList","addToList","loadListAsync","merge","params","message","Pagination","currentPage","perPage","total","onChange","itemClass","linkClass","activePage","itemsCountPerPage","totalItemsCount","pageRangeDisplayed","moment","locale","EventStatuses","EventStatusLabels","EventStatusClasses","EventDetailStatuses","isRemove","status","draft","reject","moderation","approved","utcOffset","timezoneUTC","valueOf","startAt","subtract","Error","useEventItem","begin","end","finishAt","getFromNow","fromNow","getToFinish","timeToMeeting","setTimeToMeeting","timeToFinish","setTimeToFinish","isStarted","setIsStarted","isFinished","setIsFinished","canRemove","setCanRemove","canEditable","setCanEditable","handleCanEditable","isEditable","currentDate","useProfileEventItem","card","bg","text","badge","setParams","path","useRouteMatch","detailUrl","Card","Body","Title","Subtitle","Badge","Text","Footer","List","publicEventList","lastPage","Math","ceil","handleReloadList","handleNextPage","handleMoreList","useEventList","items","Alert","Spinner","size","animation","Row","Col","md","faSync","sm","xs","EventList","AboutUs","Status","EventItem","format","ButtonGroup","faEye","faEdit","faTrash","EventFilterForm","onSubmit","profileEventList","hookForm","useForm","defaultValues","reset","startDate","setStartDate","handleChangeDate","date","decoratorSubmit","useEventFormSearch","register","handleSubmit","Form","Group","Label","Control","value","selected","isClearable","customInput","setSearchForm","getState","searchForm","storage","getToken","getUserId","Heading","reloadList","ProfileEvents","eventList","handleChangePagination","handleSearchForm","error","faSpinner","Profile","component","emailRegex","useLoginForm","onCompleted","success","setToken","LoginForm","errors","required","pattern","maxLength","isInvalid","email","Feedback","minLength","password","Login","isShowModal","handleCloseModal","useLoginModal","Modal","show","onHide","Header","closeButton","setDetail","useEventDetail","useParams","publicEventDetail","fetchDetailAsync","Leaflet","props","mapRef","undefined","setMap","L","options","tileLayer","attribution","addTo","onLoaded","setView","center","zoom","rad2deg","degree","PI","computeBounds","distance","lat","lng","latRadiansDistance","latDegreesDistance","lngDegreesDistance","cos","from","isPointBetweenPoints","point","points","SocketListenEvents","SocketEmitEvents","createSocket","event","queryParams","duration","finishedAt","timezone","createQueryParams","io","rememberUpgrade","transports","secure","rejectUnauthorized","query","useMap","subscribeSockets","socket","objectManager","setObjectManager","off","ADD_CONNECTION","REMOVE_CONNECTION","SET_CONNECTIONS","TOTAL_CONNECTIONS","leave","disconnect","iconUrl","storageMarkers","Map","onSetTotal","attachEvents","handlerAddMarkers","handlerRemoveMarker","cluster","setCluster","markers","addLayers","removeLayer","managerObject","markerClusterGroup","maxClusterRadius","chunkDelay","chunkInterval","chunkedLoading","zoomToBoundsOnClick","spiderfyOnMaxZoom","showCoverageOnHover","addLayer","setMaxZoom","setTotal","borders","setConnection","addPlacement","removePlacement","setTotalConnections","emit","GET_TOTAL","GET_ALL_CONNECTIONS","on","console","log","connectWebsocket","connections","createMarker","connection","marker","setStat","setMaxResult","useEventChart","eventStat","chartData","setChartData","rows","maxResult","max","row","createdAt","EventChart","totalMax","width","aspect","dataKey","stroke","waiting","toLowerCase","starting","finished","finishDate","EventDetailWrapper","useEventDetailStatus","Component","description","EventDetail","App","createReducer","fetchLoader","regionListActions","payload","regionActions","userActions","loginActions","eventStatActions","eventListActions","concat","eventDetailActions","combineReducers","middleware","createLogger","collapsed","getDefaultMiddleware","store","configureStore","reducer","Boolean","window","location","hostname","match","ReactDOM","render","document","getElementById","navigator","serviceWorker","ready","registration","unregister","catch"],"mappings":"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","file":"static/js/main.3c55476c.chunk.js","sourcesContent":["export enum Roles {\r\n  'admin' = 'admin',\r\n  'organizer' = 'organizer',\r\n  'user' = 'user'\r\n};\r\n\r\nexport type UserModelType = {\r\n  id: string;\r\n  name: string;\r\n  isVerified: boolean;\r\n  roles?: keyof typeof Roles;\r\n}\r\n\r\nexport type UserType = {\r\n  user: UserModelType;\r\n  token: string;\r\n  expired: number;\r\n}\r\n\r\nexport type UserStateType = {\r\n  user: UserModelType|null;\r\n  token: string|null;\r\n  expired: number|null;\r\n}\r\n\r\nexport enum UserResponseStatuses {\r\n  'success' = 'success',\r\n  'error' = 'error'\r\n}\r\n\r\nexport type UserResponseSuccessType = UserType & {\r\n  status: UserResponseStatuses.success\r\n}\r\n\r\nexport type UserResponseFailType = {\r\n  status: UserResponseStatuses.error;\r\n  message: string;\r\n}\r\n\r\nexport type UserResponseType = UserResponseSuccessType | UserResponseFailType;\r\n\r\nexport type TokenType = {\r\n  token: string;\r\n  userId: string;\r\n}","import { load } from \"recaptcha-v3\";\r\n\r\nconst captchaToken = async (action: string) => {\r\n  const captcha = await load(String(process.env.REACT_APP_GOOGLE_CAPTCHA_CLIENT));\r\n  return await captcha.execute(action);\r\n}\r\n\r\nexport default captchaToken;","import { createAction } from \"@reduxjs/toolkit\";\r\nimport { UserType } from \"./types\";\r\n\r\nexport const setUser = createAction<UserType>('user/set-user');\r\nexport const clearUser = createAction('user/logout-user');","export default class StorageToken {\r\n\r\n  private tokenKey: string = 'auth-token';\r\n  private userKey: string = 'user-auth-id';\r\n  private expiredKey: string = 'expired-token';\r\n\r\n  public setToken(token: string, userId: string, expired: number = 0): void {\r\n    localStorage.setItem(this.tokenKey, token);\r\n    localStorage.setItem(this.userKey, userId);\r\n    localStorage.setItem(this.expiredKey, String(expired));\r\n  }\r\n\r\n  public getToken(): string|null {\r\n    return localStorage.getItem(this.tokenKey);\r\n  }\r\n\r\n  public getUserId(): string|null {\r\n    return localStorage.getItem(this.userKey);\r\n  }\r\n\r\n  public getExpiredAt(): number|null {\r\n    const expired: string|null = localStorage.getItem(this.expiredKey);\r\n    return expired ? +expired : null;\r\n  }\r\n\r\n  public isExpired(): boolean {\r\n    const expiredAt = this.getExpiredAt();\r\n    return expiredAt ? expiredAt < (new Date()).getTime() : true;\r\n  }\r\n\r\n  public clear() {\r\n    localStorage.removeItem(this.tokenKey);\r\n    localStorage.removeItem(this.userKey);\r\n    localStorage.removeItem(this.expiredKey);\r\n  }\r\n}","export default {\r\n  root: process.env.REACT_APP_API_BASE_URL\r\n}","import axios from \"axios\";\r\n\r\nconst authHeaders = (userId: string, token: string) => {\r\n  return {\r\n    'X-AUTH-ID': userId,\r\n    Authorization: `Bearer ${token}`\r\n  }\r\n}\r\n\r\nexport {\r\n  axios as http,\r\n  authHeaders\r\n}","import config from \"./config\";\r\nimport { http, authHeaders } from \"../services/http\";\r\n\r\n// Types\r\nimport { RegionType } from \"../store/regions/types\";\r\nimport { TokenType, UserModelType, UserResponseType } from \"../store/user/types\";\r\nimport { LoginFormType } from \"../store/login/types\";\r\nimport { EventFilterParamsType, EventListType } from \"../store/events/profile/list/types\";\r\nimport { EventPublicListFilterType, EventPublicListType } from \"../store/events/public/list/types\";\r\nimport { EventDetailResponseType } from \"../store/events/public/detail/types\";\r\nimport { EventStatisticType } from \"../store/eventStatistic/types\";\r\n\r\nexport type ApiConfigType = {\r\n  region: {\r\n    list: () => Promise<RegionType[]>\r\n  },\r\n  auth: {\r\n    login: (credentials: LoginFormType) => Promise<UserResponseType>,\r\n    checkToken: (token: TokenType) => Promise<UserModelType>\r\n  },\r\n  profile: {\r\n    events: {\r\n      list: (token: TokenType, page: number, form: EventFilterParamsType) => Promise<EventListType>\r\n    }\r\n  },\r\n  public: {\r\n    events: {\r\n      list: (page: number, form: EventPublicListFilterType) => Promise<EventPublicListType>,\r\n      detail: (id: number) => Promise<EventDetailResponseType>,\r\n      stat: (eventId: number) => Promise<EventStatisticType[]>\r\n    }\r\n  }\r\n}\r\n\r\nconst api: ApiConfigType = {\r\n  region: {\r\n    list: () => http.get<RegionType[]>(`${config.root}/region/list`)\r\n      .then(response => response.data),\r\n  },\r\n  auth: {\r\n    login: (credentials) => http.post<UserResponseType>(`${config.root}/login`, credentials)\r\n      .then(response => response.data),\r\n\r\n    checkToken: (token) => http.get<UserModelType>(`${config.root}/user`, {\r\n      headers: authHeaders(token.userId, token.token)\r\n    }).then(response => response.data),\r\n  },\r\n  profile: {\r\n    events: {\r\n      list: (token, page, form) => http.post<EventListType>(`${config.root}/profile/event/list`, { page, ...form }, {\r\n        headers: authHeaders(token.userId, token.token)\r\n      }).then(response => response.data)\r\n    }\r\n  },\r\n  public: {\r\n    events: {\r\n      list: (page, form) => http.post(`${config.root}/event/list`, { page, ...form })\r\n        .then(response => response.data),\r\n\r\n      detail: (id: number) => http.get(`${config.root}/event/view/${id}`)\r\n        .then(response => response.data),\r\n\r\n      stat: (eventId: number) => http.get(`${config.root}/event/view/${eventId}/stat`)\r\n        .then(response => response.data)\r\n    }\r\n  }\r\n};\r\n\r\nexport default api;","import { createAction } from \"@reduxjs/toolkit\";\r\nimport captchaToken from \"../../services/captcha\";\r\nimport { setUser, clearUser } from \"../user/actions\";\r\nimport StorageToken from \"../user/StorageToken\";\r\n\r\n// Types\r\nimport { UserResponseStatuses, UserType } from \"../user/types\";\r\nimport { LoginFormType } from \"./types\";\r\nimport { AppThunk } from \"../store\";\r\n\r\n// Api\r\nimport api from \"../../api\";\r\n\r\nexport const setLoader = createAction<boolean>('login/set-loader');\r\nexport const setError = createAction<string|null>('login/set-error');\r\nexport const setSuccess = createAction<string|null>('login/set-success');\r\nexport const showModal = createAction('login/show-modal');\r\nexport const hideModal = createAction('login/hide-modal');\r\n\r\nexport const loginAsync = (credentials: LoginFormType): AppThunk => async (dispatch) => {\r\n  dispatch(setLoader(true));\r\n\r\n  try {\r\n    const captcha: string = await captchaToken('login');\r\n    const response = await api.auth.login({...credentials, captcha});\r\n\r\n    if (response.status === UserResponseStatuses.success) {\r\n      const user: UserType = {\r\n        user: response.user,\r\n        token: response.token,\r\n        expired: response.expired\r\n      };\r\n\r\n      const storage = new StorageToken();\r\n      storage.setToken(user.token, user.user.id, user.expired);\r\n\r\n      dispatch(setUser(user));\r\n      dispatch(setSuccess('logged in'));\r\n    } else {\r\n      dispatch(setError(response.message));\r\n    }\r\n  } catch (e) {\r\n    dispatch(setError(e.message));\r\n  } finally {\r\n    dispatch(setLoader(false));\r\n  }\r\n};\r\n\r\nexport const logoutAsync = (): AppThunk => dispatch => {\r\n  const storage = new StorageToken();\r\n  storage.clear();\r\n\r\n  dispatch(clearUser());\r\n};\r\n\r\nexport const autoLoginAsync = (): AppThunk => async (dispatch) => {\r\n  const storage = new StorageToken();\r\n  const token = storage.getToken();\r\n  const userId = storage.getUserId();\r\n  const expired = storage.getExpiredAt();\r\n\r\n  if (!token || !userId || !expired) {\r\n    return;\r\n  }\r\n\r\n  dispatch(setLoader(true));\r\n\r\n  try {\r\n    const user = await api.auth.checkToken({ token, userId });\r\n    dispatch(setUser({ user, token, expired }));\r\n  } catch (e) {\r\n    storage.clear();\r\n  } finally {\r\n    dispatch(setLoader(false));\r\n  }\r\n};","import React, {\r\n  FC,\r\n  ReactElement,\r\n  RefAttributes,\r\n  useEffect,\r\n  createRef,\r\n} from \"react\";\r\n\r\nexport type PropTypes = {\r\n  children: ReactElement;\r\n  nameEvent: \"bounce\" | \"pulse\" | \"flash\" | \"rubberBand\" | \"shake\" | \"swing\" | \"tada\";\r\n  interval?: number;\r\n  delay?: number;\r\n  iterations?: number;\r\n}\r\n\r\nexport const AnimationElement: FC<PropTypes> = (\r\n  { children, nameEvent, delay = 0, interval = 4, iterations }: PropTypes\r\n): ReactElement => {\r\n\r\n  // Working\r\n  const elementRef = createRef<HTMLElement>();\r\n\r\n  const element = React.cloneElement<RefAttributes<HTMLElement>>(children, {\r\n    ref: elementRef\r\n  });\r\n\r\n  useEffect(() => {\r\n    if (elementRef.current) {\r\n      const el: HTMLElement = elementRef.current;\r\n\r\n      let timer: NodeJS.Timeout;\r\n      let i: number|undefined = iterations;\r\n\r\n      el.classList.add('animated');\r\n\r\n      setTimeout(() => {\r\n        el.classList.add(nameEvent);\r\n\r\n        if (typeof i === 'number') {\r\n          i--;\r\n        }\r\n\r\n        if (interval > 0) {\r\n          timer = setInterval(() => {\r\n            el.classList.remove(nameEvent);\r\n            setTimeout(() => el.classList.add(nameEvent));\r\n\r\n            if (typeof i === 'number') {\r\n              if (i <= 1) {\r\n                clearInterval(timer);\r\n              } else {\r\n                i--;\r\n              }\r\n            }\r\n          }, interval * 1000);\r\n        }\r\n      }, delay * 1000);\r\n    }\r\n  }, [1]);\r\n\r\n  return element;\r\n}","import React, { FC, useState } from \"react\";\r\nimport { Button, Nav } from \"react-bootstrap\";\r\nimport { NavLink, Link } from \"react-router-dom\";\r\nimport { AnimationElement } from \"../AnimationElement/AnimationElement\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport { faBars } from \"@fortawesome/free-solid-svg-icons\";\r\n\r\nexport const SideBar: FC = () => {\r\n\r\n  const [isSidebar, toggleSidebar] = useState<boolean>(true);\r\n\r\n  const handleToggleSidebar = () => {\r\n    toggleSidebar(prev => !prev);\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <nav id=\"sidebar\" className={isSidebar ? 'active' : ''}>\r\n        <div className=\"custom-menu\">\r\n          <button type=\"button\" onClick={handleToggleSidebar}>\r\n            <FontAwesomeIcon icon={faBars} />\r\n            <span className=\"sr-only\">Toggle Menu</span>\r\n          </button>\r\n        </div>\r\n        <div className=\"sidebar-content p-4\">\r\n          <h1 className=\"sidebar-content-top display-5 font-weight-bolder text-white mb-4\">\r\n            <Link to={'/'} className=\"sidebar-content-logo\">\r\n              Our<span className=\"text-warning\">Rights</span>\r\n              <span className=\"d-block text-secondary mt-1\">\r\n                Онлайн митинги\r\n              </span>\r\n            </Link>\r\n          </h1>\r\n          <div className=\"sidebar-content-center\">\r\n            <Nav className=\"flex-column\">\r\n              <Nav.Link as={NavLink} to={'/'} exact className=\"sidebar-nav-link\">\r\n                Главная\r\n              </Nav.Link>\r\n              <Nav.Link as={NavLink} to={'/events'} className=\"sidebar-nav-link\">\r\n                События\r\n              </Nav.Link>\r\n              <Nav.Link as={NavLink} to={'/about'} className=\"sidebar-nav-link\">\r\n                О проекте\r\n              </Nav.Link>\r\n            </Nav>\r\n          </div>\r\n          <div className=\"sidebar-content-bottom text-center\">\r\n            <AnimationElement nameEvent=\"shake\" delay={4} interval={10} iterations={5}>\r\n              <Button\r\n                variant=\"warning\"\r\n                className=\"left-col-donate-button depth-1\"\r\n              >Donate</Button>\r\n            </AnimationElement>\r\n          </div>\r\n        </div>\r\n      </nav>\r\n\r\n      <div onClick={handleToggleSidebar} className=\"sidebar-shadow\" />\r\n    </>\r\n  );\r\n}","import { createAction } from \"@reduxjs/toolkit\";\r\nimport { RegionType } from \"../types\";\r\nimport { AppThunk } from \"../../store\";\r\n\r\nexport const setItem = createAction<RegionType>('region/set-item');\r\n\r\nexport const setRegionAsync = (region: RegionType): AppThunk => dispatch => {\r\n  dispatch(setItem(region));\r\n  localStorage.setItem('regionSelected', region.slug);\r\n};","import { createAction } from \"@reduxjs/toolkit\";\r\nimport { AppThunk } from \"../../store\";\r\nimport { RegionType } from \"../types\";\r\nimport api from \"../../../api\";\r\n\r\nimport { setRegionAsync } from \"../item/actions\";\r\nimport { isString } from \"../../../guards\";\r\n\r\nexport const setLoader = createAction<boolean>('region/list-loader');\r\nexport const setList = createAction<RegionType[]>('region/list-set');\r\n\r\nexport const getListRegionsAsync = (): AppThunk => async dispatch => {\r\n  dispatch(setLoader(true));\r\n\r\n  try {\r\n    const list = await api.region.list();\r\n    dispatch(setList(list));\r\n\r\n    const regionSelected: string|null = localStorage.getItem('regionSelected');\r\n\r\n    if (list.length > 0) {\r\n      dispatch(setRegionAsync(\r\n        list.find(item => item.slug === regionSelected) || list[0]\r\n      ));\r\n    }\r\n  } catch (e) {\r\n    dispatch(setList([]))\r\n  } finally {\r\n    dispatch(setLoader(false));\r\n  }\r\n};","import React, { useEffect } from \"react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\n\r\n// Types\r\nimport { RootState } from \"../../../store/store\";\r\nimport { RegionStateType } from \"../../../store/regions/item/types\";\r\nimport { RegionsStateType } from \"../../../store/regions/list/types\";\r\nimport { RegionType } from \"../../../store/regions/types\";\r\n\r\n// Actions\r\nimport { setRegionAsync } from \"../../../store/regions/item/actions\";\r\nimport { getListRegionsAsync } from \"../../../store/regions/list/actions\";\r\n\r\nexport type HookRegionDropdownType = {\r\n  region: RegionType;\r\n  regions: RegionsStateType;\r\n  handleChangeRegion: (regionItem: RegionType) => void;\r\n};\r\n\r\nexport const useRegionDropdown = () => {\r\n  const dispatch = useDispatch();\r\n\r\n  const { region } = useSelector<RootState, RegionStateType>(state => state.region);\r\n  const regions = useSelector<RootState, RegionsStateType>(state => state.regions);\r\n\r\n  useEffect(() => {\r\n    // get all regions\r\n    dispatch(getListRegionsAsync());\r\n  }, [dispatch]);\r\n\r\n  const handleChangeRegion = (regionItem: RegionType) => {\r\n    dispatch(setRegionAsync(regionItem));\r\n  };\r\n\r\n  return {\r\n    region,\r\n    regions,\r\n    handleChangeRegion\r\n  };\r\n};","import React, { FC } from \"react\";\r\nimport { useRegionDropdown } from \"./hooks/hookRegionDropdown\";\r\nimport { NavDropdown } from \"react-bootstrap\";\r\n\r\nexport const RegionsDropdown: FC = () => {\r\n\r\n  const { region, regions, handleChangeRegion } = useRegionDropdown();\r\n\r\n  return (\r\n    <NavDropdown id=\"region-list\" title={region ? region.label : 'Выбрать регион'}>\r\n      {regions.regions.map(regionItem => (\r\n        <NavDropdown.Item\r\n          key={regionItem.slug}\r\n          className={regionItem.slug === region?.slug ? 'active' : ''}\r\n          onClick={() => handleChangeRegion(regionItem)}\r\n        >{regionItem.label}</NavDropdown.Item>\r\n      ))}\r\n    </NavDropdown>\r\n  );\r\n}","import React from \"react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\n\r\n// Types\r\nimport { RootState } from \"../../../store/store\";\r\nimport { LoginStateType } from \"../../../store/login/types\";\r\nimport { UserModelType, UserStateType } from \"../../../store/user/types\";\r\n\r\n// Actions\r\nimport { logoutAsync, showModal } from \"../../../store/login/actions\";\r\n\r\nexport type HookUserDropdownType = {\r\n  user: UserModelType|null;\r\n  loaderLoginForm: boolean;\r\n  handlerLogout: () => void;\r\n  handleShowModal: () => void;\r\n}\r\n\r\nexport const useUserDropdown = (): HookUserDropdownType => {\r\n  const dispatch = useDispatch();\r\n\r\n  const { loader: loaderLoginForm } = useSelector<RootState, LoginStateType>(state => state.login);\r\n  const { user } = useSelector<RootState, UserStateType>(state => state.user);\r\n\r\n  const handlerLogout = () => {\r\n    dispatch(logoutAsync());\r\n  };\r\n\r\n  const handleShowModal = () => dispatch(showModal());\r\n\r\n  return {\r\n    user,\r\n    loaderLoginForm,\r\n    handlerLogout,\r\n    handleShowModal,\r\n  };\r\n}","import React, { FC } from \"react\";\r\nimport { Nav, NavDropdown } from \"react-bootstrap\";\r\nimport { useUserDropdown } from \"./hooks/hookUserDropdown\";\r\n\r\nexport const UserDropdown: FC = () => {\r\n\r\n  const {\r\n    user,\r\n    loaderLoginForm,\r\n    handlerLogout,\r\n    handleShowModal\r\n  } = useUserDropdown();\r\n\r\n  return (\r\n    <>\r\n      {user ? (\r\n        <NavDropdown drop={'left'} id=\"user-profile\" title={user.name}>\r\n          <NavDropdown.Item>\r\n            Профиль\r\n          </NavDropdown.Item>\r\n          <NavDropdown.Item onClick={handlerLogout}>\r\n            Выйти\r\n          </NavDropdown.Item>\r\n        </NavDropdown>\r\n      ) : (\r\n        <Nav.Item>\r\n          <Nav.Link\r\n            disabled={loaderLoginForm}\r\n            onClick={handleShowModal}\r\n          >Войти</Nav.Link>\r\n        </Nav.Item>\r\n      )}\r\n    </>\r\n  );\r\n}","import React, { FC } from \"react\";\r\nimport { Nav, Navbar } from \"react-bootstrap\";\r\nimport { RegionsDropdown } from \"./RegionsDropdown\";\r\nimport { UserDropdown } from \"./UserDropdown\";\r\n\r\nexport const Menu: FC = () => {\r\n  return (\r\n    <Navbar expand=\"lg\" className=\"mb-4\">\r\n      <Nav className=\"mr-auto\">\r\n        <RegionsDropdown />\r\n      </Nav>\r\n      <Nav>\r\n        <UserDropdown />\r\n      </Nav>\r\n    </Navbar>\r\n  )\r\n};","import React, { FC, ReactNode, createRef } from \"react\";\r\nimport { useHistory } from \"react-router-dom\";\r\n\r\ntype PropTypes = {\r\n  children: ReactNode;\r\n}\r\n\r\nexport const Content: FC<PropTypes> = ({ children }: PropTypes) => {\r\n  return (\r\n    <div className=\"container py-sm-3 py-md-5 content animated fadeInDownBig\">\r\n      {children}\r\n    </div>\r\n  )\r\n}","import React, { FC } from \"react\";\r\nimport { Content } from \"../../Layouts/Content\";\r\n\r\nexport const Home: FC = () => (\r\n  <Content>\r\n    <h1>Hello</h1>\r\n  </Content>\r\n)","import { createAction } from \"@reduxjs/toolkit\";\r\nimport api from \"../../../../api\";\r\n\r\n// Types\r\nimport { AppThunk } from \"../../../store\";\r\nimport { EventPublicListFilterType, EventPublicListType } from \"./types\";\r\nimport { EventListType } from \"../../profile/list/types\";\r\n\r\nexport const setToList = createAction<EventPublicListType>('event-list-public/set');\r\nexport const addToList = createAction<EventPublicListType>('event-list-public/add');\r\nexport const setLoader = createAction<boolean>('event-list-public/set-loader');\r\nexport const setError = createAction<string>('event-list-public/set-error');\r\n\r\nexport const loadListAsync = (\r\n  page: number,\r\n  merge: boolean,\r\n  params: EventPublicListFilterType\r\n): AppThunk => async dispatch => {\r\n  dispatch(setLoader(true));\r\n\r\n  try {\r\n    const data: EventListType = await api.public.events.list(page, params);\r\n\r\n    if (merge) {\r\n      dispatch(addToList(data));\r\n    } else {\r\n      dispatch(setToList(data));\r\n    }\r\n  } catch (e) {\r\n    dispatch(setError(e.message));\r\n  } finally {\r\n    dispatch(setLoader(false));\r\n  }\r\n};","import React, { FC } from \"react\";\r\nimport PaginationComponent from \"react-js-pagination\";\r\n\r\nexport type PaginationPropTypes = {\r\n  currentPage: number;\r\n  perPage: number;\r\n  total: number;\r\n  disabled: boolean;\r\n  onChange: (page: number) => void;\r\n};\r\n\r\nexport const Pagination: FC<PaginationPropTypes> = (\r\n  { currentPage, perPage, total, disabled, onChange }: PaginationPropTypes\r\n) => {\r\n\r\n  if (total <= perPage) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <PaginationComponent\r\n      itemClass=\"page-item\"\r\n      linkClass=\"page-link\"\r\n      activePage={currentPage}\r\n      itemsCountPerPage={perPage}\r\n      totalItemsCount={total}\r\n      pageRangeDisplayed={5}\r\n      onChange={disabled ? () => {} : onChange}\r\n    />\r\n  )\r\n}","import moment from \"moment\";\r\nimport 'moment/locale/ru';\r\n\r\nmoment.locale('ru');\r\n\r\nexport default moment;","import { RegionType } from \"../regions/types\";\r\nimport { UserModelType } from \"../user/types\";\r\n\r\nexport enum EventStatuses {\r\n  'draft' = 'draft',\r\n  'moderation' = 'moderation',\r\n  'reject' = 'reject',\r\n  'approved' = 'approved'\r\n}\r\n\r\nexport enum EventStatusLabels {\r\n  'draft' = 'Черновик',\r\n  'moderation' = 'На модерации',\r\n  'reject' = 'Отклонен',\r\n  'approved' = 'Активен'\r\n}\r\n\r\nexport enum EventStatusClasses {\r\n  'draft' = 'secondary',\r\n  'moderation' = 'warning',\r\n  'reject' = 'danger',\r\n  'approved' = 'success'\r\n}\r\n\r\nexport type EventType = {\r\n  id: number;\r\n  interval: number; // hours\r\n  title: string;\r\n  description: string;\r\n  region: RegionType;\r\n  user: UserModelType;\r\n  createdAt?: number;\r\n  updatedAt?: number;\r\n  startAt: number;\r\n  finishAt: number;\r\n  status: keyof typeof EventStatuses;\r\n  timezoneUTC: string;\r\n  isStarted: boolean;\r\n  isFinished: boolean;\r\n};\r\n\r\n","import { EventStatuses, EventType } from \"../types\";\r\nimport moment from \"../../../services/moment\";\r\n\r\nexport const isRemove = (item: EventType): boolean => {\r\n  if (item.status === EventStatuses.draft || item.status === EventStatuses.reject) {\r\n    return true;\r\n  } else if (item.status === EventStatuses.moderation) {\r\n    return false;\r\n  } else if (item.status === EventStatuses.approved) {\r\n    const currentDate = moment().utcOffset(item.timezoneUTC).valueOf();\r\n    const meetingStart = moment(new Date(item.startAt)).subtract(3, 'days').valueOf();\r\n\r\n    if (currentDate >= meetingStart) {\r\n      return false;\r\n    }\r\n\r\n    return true;\r\n  }\r\n\r\n  throw new Error(`${item.status} undefined status`);\r\n}\r\n\r\nexport const isEditable = (item: EventType): boolean => {\r\n  return isRemove(item);\r\n}","import { EventType } from \"../../types\";\r\n\r\nexport type EventDetailStateType = {\r\n  loader: boolean;\r\n  detail: EventType|null;\r\n  error: string|null;\r\n}\r\n\r\nexport enum EventDetailStatuses {\r\n  'success' = 'success',\r\n  'error' = 'error'\r\n}\r\n\r\nexport type EventDetailSuccessResponse = {\r\n  status: EventDetailStatuses.success;\r\n  detail: EventType;\r\n}\r\n\r\nexport type EventDetailFailResponse = {\r\n  status: EventDetailStatuses.error;\r\n  message: string;\r\n}\r\n\r\nexport type EventDetailResponseType = EventDetailSuccessResponse | EventDetailFailResponse;","import { useEffect, useState } from \"react\";\r\nimport moment from \"../../../../../services/moment\";\r\nimport { isRemove, isEditable } from \"../../../../../store/events/profile/rules\";\r\n\r\n// Types\r\nimport { EventType } from \"../../../../../store/events/types\";\r\n\r\nexport type HookEventFormSearchResponse = {\r\n  begin: moment.Moment;\r\n  end: moment.Moment;\r\n  timeToMeeting: string;\r\n  timeToFinish: string;\r\n  isStarted: boolean;\r\n  isFinished: boolean;\r\n  canRemove: boolean;\r\n  canEditable: boolean;\r\n};\r\n\r\nexport const useEventItem = (item: EventType): HookEventFormSearchResponse => {\r\n  const begin = moment(new Date(item.startAt));\r\n  const end = moment(new Date(item.finishAt));\r\n\r\n  const getFromNow = (): string => begin.fromNow();\r\n  const getToFinish = (): string => end.fromNow();\r\n\r\n  const [timeToMeeting, setTimeToMeeting] = useState<string>(getFromNow());\r\n  const [timeToFinish, setTimeToFinish] = useState<string>(getToFinish());\r\n\r\n  const [isStarted, setIsStarted] = useState<boolean>(item.isStarted);\r\n  const [isFinished, setIsFinished] = useState<boolean>(item.isFinished);\r\n  const [canRemove, setCanRemove] = useState<boolean>(false);\r\n  const [canEditable, setCanEditable] = useState<boolean>(false);\r\n\r\n  const handleCanRemove = () => setCanRemove(isRemove(item));\r\n  const handleCanEditable = () => setCanEditable(isEditable(item));\r\n\r\n  useEffect(() => {\r\n    const timer = setInterval(() => {\r\n      const currentDate: number = moment().valueOf();\r\n\r\n      if (currentDate >= begin.valueOf() && currentDate < end.valueOf()) {\r\n        setIsStarted(true);\r\n      }\r\n\r\n      if (currentDate >= end.valueOf()) {\r\n        setIsFinished(true);\r\n      }\r\n\r\n      setTimeToMeeting(getFromNow());\r\n      setTimeToFinish(getToFinish());\r\n\r\n      handleCanRemove();\r\n      handleCanEditable();\r\n    }, 1000);\r\n\r\n    return function cleanup() {\r\n      clearInterval(timer);\r\n    }\r\n  }, [item.id]);\r\n\r\n  return {\r\n    begin,\r\n    end,\r\n    timeToMeeting,\r\n    timeToFinish,\r\n    isStarted,\r\n    isFinished,\r\n    canRemove,\r\n    canEditable\r\n  };\r\n}","import React, { FC } from \"react\";\r\nimport { Card, Badge, Button } from \"react-bootstrap\";\r\nimport { Link, useRouteMatch } from \"react-router-dom\";\r\nimport { useEventItem } from \"./hooks/hookEventItem\";\r\n\r\n// Types\r\nimport { EventType } from \"../../../../store/events/types\";\r\n\r\ntype PropTypes = {\r\n  item: EventType;\r\n}\r\n\r\nexport const Item: FC<PropTypes> = ({ item }: PropTypes) => {\r\n\r\n  const { timeToMeeting, isStarted, isFinished, params } = useEventItem(item);\r\n  const { path } = useRouteMatch();\r\n\r\n  const detailUrl: string = `${path}/${item.id}`;\r\n\r\n  return (\r\n    <Card {...params.card} className=\"circle-effect\">\r\n      <Card.Body>\r\n        <Card.Title>\r\n          {item.region.label}\r\n\r\n          <Card.Subtitle className=\"mt-1\">\r\n            <Badge {...params.badge} className=\"depth-1\">{timeToMeeting}</Badge>\r\n          </Card.Subtitle>\r\n        </Card.Title>\r\n        <Card.Text>\r\n          {item.title}\r\n        </Card.Text>\r\n      </Card.Body>\r\n      <Card.Footer>\r\n        {isFinished ? (\r\n          <Button as={Link} to={detailUrl} variant=\"link\" className=\"text-white\">\r\n            Посмотреть\r\n          </Button>\r\n        ) : (\r\n          isStarted ? (\r\n            <Button as={Link} to={detailUrl} variant=\"success\" className=\"depth-1\">\r\n              Принять участие\r\n            </Button>\r\n          ) : (\r\n            <Button as={Link} to={detailUrl} variant=\"success\" className=\"depth-1\">\r\n              Приму участие\r\n            </Button>\r\n          )\r\n        )}\r\n      </Card.Footer>\r\n    </Card>\r\n  )\r\n}","import React, { useEffect, useState } from \"react\";\r\nimport { BadgeProps, CardProps } from \"react-bootstrap\";\r\nimport { useEventItem as useProfileEventItem } from \"../../../Profile/Events/hooks/hookEventItem\";\r\n\r\n// Types\r\nimport { EventType } from \"../../../../../store/events/types\";\r\n\r\ntype ParamColorsType = {\r\n  card: CardProps;\r\n  badge: BadgeProps;\r\n}\r\n\r\nexport const useEventItem = (item: EventType) => {\r\n  const { timeToMeeting, isStarted, isFinished } = useProfileEventItem(item);\r\n\r\n  const [params, setParams] = useState<ParamColorsType>({\r\n    card: {\r\n      bg: 'success',\r\n      text: 'light'\r\n    },\r\n    badge: {\r\n      variant: 'primary'\r\n    }\r\n  });\r\n\r\n  useEffect(() => {\r\n    if (isFinished) {\r\n      setParams({\r\n        card: {\r\n          bg: 'primary',\r\n          text: 'light'\r\n        },\r\n        badge: {\r\n          variant: 'dark'\r\n        }\r\n      })\r\n    }\r\n  }, [isFinished]);\r\n\r\n  return {\r\n    timeToMeeting,\r\n    isStarted,\r\n    isFinished,\r\n    params\r\n  };\r\n}","import React, { FC } from \"react\";\r\nimport { Button, Row, Col, Spinner, Alert } from \"react-bootstrap\";\r\nimport { useEventList } from \"./hooks/hookEventList\";\r\nimport { Pagination } from \"../../../UI/Pagination/Pagination\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport { faSpinner, faSync } from \"@fortawesome/free-solid-svg-icons\";\r\nimport { Item } from \"./Item\";\r\n\r\nexport const List: FC = () => {\r\n\r\n  const {\r\n    list: { loader, currentPage, perPage, items, total },\r\n    lastPage,\r\n    region,\r\n    handleReloadList,\r\n    handleMoreList,\r\n    handleNextPage\r\n  } = useEventList();\r\n\r\n  if (region === null) {\r\n    return (\r\n      <Alert variant=\"warning\">\r\n        Подождите... <Spinner size=\"sm\" animation=\"border\" variant=\"dark\" />\r\n      </Alert>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      <Row className=\"justify-content-between mb-4\">\r\n        <Col md=\"auto\" className=\"mb-sm-2 mb-md-0\">\r\n          <p>Всего событий: {total}</p>\r\n        </Col>\r\n        <Col md=\"auto\">\r\n          <Button variant=\"outline-secondary\" onClick={handleReloadList}>\r\n            {loader ? (\r\n              <Spinner size=\"sm\" animation=\"border\" variant=\"primary\" />\r\n            ) : (\r\n              <FontAwesomeIcon icon={faSync} />\r\n            )}\r\n          </Button>\r\n        </Col>\r\n      </Row>\r\n\r\n      <Row>\r\n        {items.map(item => (\r\n          <Col key={item.id} md={4} sm={6} xs={12} className=\"mb-4\">\r\n            <Item item={item} />\r\n          </Col>\r\n        ))}\r\n      </Row>\r\n\r\n      <div className=\"d-flex justify-content-center\">\r\n        <Pagination\r\n          currentPage={currentPage}\r\n          perPage={perPage}\r\n          total={total}\r\n          disabled={loader}\r\n          onChange={handleNextPage}\r\n        />\r\n      </div>\r\n\r\n      {currentPage === lastPage ? null : (\r\n        <div className=\"text-center\">\r\n          <Button size=\"lg\" variant=\"info\" onClick={handleMoreList}>\r\n            Показать ещё\r\n            <FontAwesomeIcon className=\"ml-2\" icon={faSync} />\r\n          </Button>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}","import React, { useEffect } from \"react\";\r\nimport { useSelector, useDispatch } from \"react-redux\";\r\n\r\n// Types\r\nimport { RootState } from \"../../../../../store/store\";\r\nimport { RegionStateType } from \"../../../../../store/regions/item/types\";\r\nimport { EventPublicListStateType } from \"../../../../../store/events/public/list/types\";\r\nimport { RegionType } from \"../../../../../store/regions/types\";\r\n\r\n// Actions\r\nimport { loadListAsync } from \"../../../../../store/events/public/list/actions\";\r\n\r\nexport type HookEventListType = {\r\n  list: EventPublicListStateType;\r\n  lastPage: number;\r\n  region: RegionType|null,\r\n  handleReloadList: () => void;\r\n  handleNextPage: (page: number) => void;\r\n  handleMoreList: () => void;\r\n};\r\n\r\nexport const useEventList = (): HookEventListType => {\r\n\r\n  const dispatch = useDispatch();\r\n\r\n  const { region } = useSelector<RootState, RegionStateType>(state => state.region);\r\n  const list = useSelector<RootState, EventPublicListStateType>(state => state.publicEventList);\r\n\r\n  const params = { region: region?.id };\r\n\r\n  useEffect(() => {\r\n    if (region) {\r\n      dispatch(loadListAsync(1, false, params));\r\n    }\r\n  }, [region]);\r\n\r\n  const handleReloadList = () => dispatch(loadListAsync(1, false, params));\r\n  const handleNextPage = (page: number) => dispatch(loadListAsync(page, false, params));\r\n  const handleMoreList = () => dispatch(loadListAsync(list.currentPage + 1, true, params));\r\n\r\n  const lastPage: number = Math.ceil(list.total / list.perPage);\r\n\r\n  return {\r\n    list,\r\n    lastPage,\r\n    region,\r\n    handleReloadList,\r\n    handleNextPage,\r\n    handleMoreList\r\n  };\r\n};","import React, { FC } from \"react\";\r\nimport { Content } from \"../../../Layouts/Content\";\r\nimport { List } from \"./List\";\r\n\r\nexport const EventList: FC = () => {\r\n  return (\r\n    <Content>\r\n      <h1 className=\"mb-4\">\r\n        Все события\r\n      </h1>\r\n\r\n      <List />\r\n    </Content>\r\n  )\r\n}","import React, { FC } from \"react\";\r\nimport { Content } from \"../../Layouts/Content\";\r\n\r\nexport const AboutUs: FC = () => (\r\n  <Content>\r\n    <h1>About us</h1>\r\n  </Content>\r\n)","import React, { FC } from \"react\";\r\nimport { Badge, ButtonGroup, Button } from \"react-bootstrap\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport { faEye, faEdit, faTrash } from \"@fortawesome/free-solid-svg-icons\";\r\nimport { useEventItem } from \"../hooks/hookEventItem\";\r\n\r\n// Types\r\nimport {\r\n  EventStatusClasses,\r\n  EventStatuses,\r\n  EventStatusLabels,\r\n  EventType\r\n} from \"../../../../../store/events/types\";\r\n\r\ntype PropTypes = {\r\n  item: EventType;\r\n}\r\n\r\ntype StatusPropTypes = {\r\n  item: EventType;\r\n  isStarted: boolean;\r\n  isFinished: boolean;\r\n  timeToMeeting: string;\r\n}\r\n\r\nconst Status: FC<StatusPropTypes> = ({ item, isFinished, isStarted, timeToMeeting }: StatusPropTypes) => {\r\n  let statusMeeting = null;\r\n\r\n  if (item.status === EventStatuses.approved) {\r\n    if (isFinished) {\r\n      statusMeeting = <Badge variant=\"info\">Мероприятие закончено</Badge>;\r\n    } else if (isStarted && !isFinished) {\r\n      statusMeeting = <Badge variant=\"success\">Проходит сейчас!</Badge>\r\n    } else {\r\n      statusMeeting = <small className=\"text-success d-block\">Митинг начнется {timeToMeeting}</small>;\r\n    }\r\n  } else {\r\n    statusMeeting = <Badge variant={EventStatusClasses[item.status]}>\r\n      {EventStatusLabels[item.status]}\r\n    </Badge>\r\n  }\r\n\r\n  return statusMeeting;\r\n}\r\n\r\nexport const EventItem: FC<PropTypes> = ({ item }: PropTypes) => {\r\n\r\n  const {\r\n    begin, end, isStarted, isFinished, timeToMeeting, canEditable, canRemove\r\n  } = useEventItem(item);\r\n\r\n  return (\r\n    <div className=\"border-top border-bottom border-light row py-sm-3 py-md-4 align-items-center justify-content-between\">\r\n      <div className=\"col-md-2 mb-sm-2 mb-md-0\">\r\n        <Status\r\n          item={item}\r\n          isStarted={isStarted}\r\n          isFinished={isFinished}\r\n          timeToMeeting={timeToMeeting}\r\n        />\r\n      </div>\r\n      <div className=\"col-md-3 mb-sm-2 mb-md-0\">\r\n        {item.title}\r\n      </div>\r\n      <div className=\"col-md-auto text-uppercase mb-sm-2\">\r\n        {item.region.label} <small>{item.timezoneUTC}</small>\r\n      </div>\r\n      <div className=\"col-md-auto mb-sm-2 mb-md-0\">\r\n        {begin.format('Do MMMM, c HH:mm')} - {end.format('HH:mm')}<br />\r\n        <span>Длительность</span> {item.interval} ч.\r\n      </div>\r\n      <div className=\"col-sm-12 col-md-auto mb-sm-2 mb-md-0\">\r\n        <ButtonGroup size=\"sm\">\r\n          {item.status === EventStatuses.approved ? (\r\n            <Button as={Link} variant=\"info\" to={`/events/${item.id}`}>\r\n              <FontAwesomeIcon icon={faEye} />\r\n            </Button>\r\n          ) : null}\r\n          {canEditable ? (\r\n            <Button as={Link} variant=\"warning\" to={`/profile/events/edit/${item.id}`}>\r\n              <FontAwesomeIcon icon={faEdit} />\r\n            </Button>\r\n          ) : null}\r\n          {canRemove ? (\r\n            <Button variant=\"danger\" type=\"button\">\r\n              <FontAwesomeIcon icon={faTrash} />\r\n            </Button>\r\n          ) : null}\r\n        </ButtonGroup>\r\n      </div>\r\n    </div>\r\n  )\r\n}","import React, { FC } from \"react\";\r\nimport { Row, Col } from \"react-bootstrap\";\r\nimport { EventType } from \"../../../../../store/events/types\";\r\nimport { EventItem } from \"./EventItem\";\r\n\r\ntype PropTypes = {\r\n  items: EventType[];\r\n}\r\n\r\nexport const EventList: FC<PropTypes> = ({ items }: PropTypes) => {\r\n  return (\r\n    <Row className=\"mt-5\">\r\n      {items.map(item => (\r\n        <Col xs={12} key={item.id}>\r\n          <EventItem item={item} key={item.id} />\r\n        </Col>\r\n      ))}\r\n    </Row>\r\n  )\r\n}","import React, { FC } from \"react\";\r\nimport DatePicker from \"react-datepicker\";\r\nimport { Form, FormControl, Row, Col, Button } from \"react-bootstrap\";\r\nimport { useEventFormSearch } from \"../hooks/hookEventFormSearch\";\r\n\r\n// Types\r\nimport { EventFilterParamsType } from \"../../../../../store/events/profile/list/types\";\r\nimport { EventStatuses, EventStatusLabels } from \"../../../../../store/events/types\";\r\n\r\ntype PropTypes = {\r\n  onSubmit: (form: EventFilterParamsType) => void;\r\n}\r\n\r\nexport const EventFilterForm: FC<PropTypes> = ({ onSubmit }: PropTypes) => {\r\n\r\n  const {\r\n    hookForm: { register, handleSubmit },\r\n    regions,\r\n    startDate,\r\n    handleChangeDate,\r\n    decoratorSubmit\r\n  } = useEventFormSearch();\r\n\r\n  return (\r\n    <Form onSubmit={handleSubmit(decoratorSubmit(onSubmit))}>\r\n      <Row>\r\n        <Col md={4}>\r\n          <Form.Group>\r\n            <Form.Label>Статус</Form.Label>\r\n            <Form.Control\r\n              as=\"select\"\r\n              name=\"status\"\r\n              ref={register<FormControl & HTMLSelectElement>()}\r\n            >\r\n              <option value=\"\">Все</option>\r\n              <option value={EventStatuses.approved}>{EventStatusLabels.approved}</option>\r\n              <option value={EventStatuses.moderation}>{EventStatusLabels.moderation}</option>\r\n              <option value={EventStatuses.draft}>{EventStatusLabels.draft}</option>\r\n              <option value={EventStatuses.reject}>{EventStatusLabels.reject}</option>\r\n            </Form.Control>\r\n          </Form.Group>\r\n        </Col>\r\n        <Col md={4}>\r\n          <Form.Group>\r\n            <Form.Label>Регион</Form.Label>\r\n            <Form.Control\r\n              as=\"select\"\r\n              name=\"regionSlug\"\r\n              ref={register<FormControl & HTMLSelectElement>()}\r\n            >\r\n              <option value=\"\">Все</option>\r\n\r\n              {regions.map(({ label, slug }) => (\r\n                <option value={slug} key={slug}>{label}</option>\r\n              ))}\r\n            </Form.Control>\r\n          </Form.Group>\r\n        </Col>\r\n        <Col md={4}>\r\n          <Form.Group>\r\n            <Form.Label>Название</Form.Label>\r\n            <Form.Control\r\n              type=\"text\"\r\n              name=\"title\"\r\n              ref={register<FormControl & HTMLInputElement>()}\r\n            />\r\n          </Form.Group>\r\n        </Col>\r\n      </Row>\r\n      <Row>\r\n        <Col md={6}>\r\n          <Form.Group>\r\n            <Form.Label>Дата начала митинга</Form.Label>\r\n\r\n            <DatePicker\r\n              selected={startDate}\r\n              onChange={handleChangeDate}\r\n              isClearable\r\n              customInput={(\r\n                <Form.Control type=\"text\" />\r\n              )}\r\n            />\r\n          </Form.Group>\r\n        </Col>\r\n      </Row>\r\n\r\n      <div>\r\n        <Button type=\"submit\" variant=\"info\">Найти</Button>\r\n      </div>\r\n    </Form>\r\n  )\r\n}","import React, { useEffect, useState } from \"react\";\r\nimport { useSelector } from \"react-redux\";\r\nimport { useForm } from \"react-hook-form\";\r\nimport moment from \"../../../../../services/moment\";\r\n\r\n// Types\r\nimport { RootState } from \"../../../../../store/store\";\r\nimport { RegionsStateType } from \"../../../../../store/regions/list/types\";\r\nimport { EventFilterParamsType, EventListStateType } from \"../../../../../store/events/profile/list/types\";\r\nimport { FormContextValues } from \"react-hook-form/dist/contextTypes\";\r\nimport { RegionType } from \"../../../../../store/regions/types\";\r\n\r\nexport type HookEventFormSearchResponse = {\r\n  hookForm: FormContextValues<EventFilterParamsType>;\r\n  regions: RegionType[];\r\n  startDate: Date|null;\r\n  handleChangeDate: (date: Date|null) => void;\r\n  decoratorSubmit: (onSubmit: (data: EventFilterParamsType) => void) => (data: EventFilterParamsType) => void;\r\n};\r\n\r\nexport const useEventFormSearch = (): HookEventFormSearchResponse => {\r\n\r\n  const { regions } = useSelector<RootState, RegionsStateType>(state => state.regions);\r\n  const { form } = useSelector<RootState, EventListStateType>(state => state.profileEventList);\r\n\r\n  const hookForm = useForm<EventFilterParamsType>({\r\n    defaultValues: form\r\n  });\r\n\r\n  useEffect(() => {\r\n    hookForm.reset(form);\r\n  }, [form]);\r\n\r\n  const [startDate, setStartDate] = useState<Date|null>(form.startDate ? new Date(form.startDate) : null);\r\n\r\n  const handleChangeDate = (date: Date|null) => {\r\n    setStartDate(date);\r\n  };\r\n\r\n  const decoratorSubmit = (onSubmit: (data: EventFilterParamsType) => void): (data: EventFilterParamsType) => void => {\r\n    return (data: EventFilterParamsType) => {\r\n      onSubmit({\r\n        ...data,\r\n        startDate: startDate ? moment(startDate).format('YYYY-MM-DD') : ''\r\n      });\r\n    }\r\n  };\r\n\r\n  return {\r\n    hookForm,\r\n    regions,\r\n    startDate,\r\n    handleChangeDate,\r\n    decoratorSubmit\r\n  };\r\n};","import { createAction } from \"@reduxjs/toolkit\";\r\nimport { AppThunk } from \"../../../store\";\r\nimport { EventFilterParamsType, EventListType } from \"./types\";\r\nimport StorageToken from \"../../../user/StorageToken\";\r\nimport api from \"../../../../api\";\r\n\r\nexport const setToList = createAction<EventListType>('event-list-profile/set');\r\nexport const addToList = createAction<EventListType>('event-list-profile/add');\r\nexport const setLoader = createAction<boolean>('event-list-profile/set-loader');\r\nexport const setError = createAction<string>('event-list-profile/set-error');\r\nexport const setSearchForm = createAction<EventFilterParamsType>('event-list-profile/set-search-form');\r\n\r\nexport const loadListAsync = (\r\n  page: number,\r\n  merge: boolean,\r\n  data?: EventFilterParamsType\r\n): AppThunk => async (dispatch, getState) => {\r\n  dispatch(setLoader(true));\r\n\r\n  if (data) {\r\n    dispatch(setSearchForm(data));\r\n  }\r\n\r\n  const searchForm = getState().profileEventList.form || {};\r\n\r\n  const storage = new StorageToken();\r\n  const token = storage.getToken();\r\n  const userId = storage.getUserId();\r\n\r\n  try {\r\n    if (!token || !userId) {\r\n      throw new Error('403');\r\n    }\r\n\r\n    const data: EventListType = await api.profile.events.list({ token, userId }, page, searchForm);\r\n\r\n    if (merge) {\r\n      dispatch(addToList(data));\r\n    } else {\r\n      dispatch(setToList(data));\r\n    }\r\n  } catch (e) {\r\n    dispatch(setError(e.message));\r\n  } finally {\r\n    dispatch(setLoader(false));\r\n  }\r\n};","import React, { FC } from \"react\";\r\nimport { Button, Spinner } from \"react-bootstrap\";\r\nimport { Content } from \"../../../Layouts/Content\";\r\nimport { EventList } from \"./List/EventList\";\r\nimport { EventFilterForm } from \"./List/EventFilterForm\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport { faSpinner, faSync } from \"@fortawesome/free-solid-svg-icons\";\r\nimport { useEventList } from \"./hooks/hookEventList\";\r\nimport { Pagination } from \"../../../UI/Pagination/Pagination\";\r\n\r\ntype HeadingPropTypes = {\r\n  total: number;\r\n  loader: boolean;\r\n  reloadList: () => void;\r\n};\r\n\r\nconst Heading: FC<HeadingPropTypes> = ({ total, loader, reloadList }: HeadingPropTypes) => (\r\n  <>\r\n    <h1 className=\"mb-4\">\r\n      Список мероприятий\r\n    </h1>\r\n\r\n    <div className=\"d-flex justify-content-between align-content-center mb-4\">\r\n      <p>Всего: <b>{total}</b></p>\r\n\r\n      <div className=\"d-flex align-content-center\">\r\n        {loader ? <Spinner animation=\"border\" variant=\"primary\" /> : null}\r\n\r\n        <Button\r\n          disabled={loader}\r\n          variant=\"outline-info\"\r\n          className=\"mx-sm-1 mx-md-2\"\r\n          onClick={reloadList}\r\n        >\r\n          <FontAwesomeIcon icon={faSync} />\r\n        </Button>\r\n\r\n        <Button>Добавить</Button>\r\n      </div>\r\n    </div>\r\n  </>\r\n)\r\n\r\nexport const ProfileEvents: FC = () => {\r\n\r\n  const {\r\n    eventList: { loader, total, items, currentPage, perPage, error, lastPage },\r\n    handleReloadList,\r\n    handleChangePagination,\r\n    handleNextPage,\r\n    handleSearchForm\r\n  } = useEventList();\r\n\r\n  return (\r\n    <Content>\r\n      {/* Local component */}\r\n      <Heading\r\n        total={total}\r\n        loader={loader}\r\n        reloadList={handleReloadList}\r\n      />\r\n\r\n      <EventFilterForm onSubmit={handleSearchForm} />\r\n\r\n      <EventList items={items} />\r\n\r\n      <div className=\"pt-4 mb-3 d-flex justify-content-center\">\r\n        <Pagination\r\n          currentPage={currentPage}\r\n          perPage={perPage}\r\n          total={total}\r\n          disabled={loader}\r\n          onChange={handleChangePagination}\r\n        />\r\n      </div>\r\n\r\n      {currentPage !== lastPage ? (\r\n        <div className=\"text-center\">\r\n          <Button\r\n            onClick={handleNextPage}\r\n            disabled={loader}\r\n            variant=\"outline-primary\"\r\n            size=\"lg\"\r\n          >\r\n            Ещё {' '} <FontAwesomeIcon className=\"ml-2\" icon={faSpinner} />\r\n          </Button>\r\n        </div>\r\n      ) : null}\r\n    </Content>\r\n  )\r\n}","import React, { useEffect } from \"react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\n\r\n// Types\r\nimport { EventFilterParamsType, EventListStateType } from \"../../../../../store/events/profile/list/types\";\r\nimport { RootState } from \"../../../../../store/store\";\r\n\r\n// Actions\r\nimport { loadListAsync } from \"../../../../../store/events/profile/list/actions\";\r\n\r\nexport type HookEventListResponse = {\r\n  eventList: EventListStateType & {\r\n    lastPage: number\r\n  };\r\n  handleReloadList: () => void;\r\n  handleChangePagination: (page: number) => void;\r\n  handleNextPage: () => void;\r\n  handleSearchForm: (data: EventFilterParamsType) => void;\r\n};\r\n\r\nexport const useEventList = (): HookEventListResponse => {\r\n  const dispatch = useDispatch();\r\n\r\n  const eventList = useSelector<RootState, EventListStateType>(state => state.profileEventList);\r\n\r\n  const lastPage = eventList.total ? Math.ceil(eventList.total / eventList.perPage) : 0;\r\n\r\n  const handleReloadList = () => dispatch(loadListAsync(1, false, {}));\r\n  const handleChangePagination = (page: number) => dispatch(loadListAsync(page, false));\r\n  const handleNextPage = () => dispatch(loadListAsync(eventList.currentPage + 1, true));\r\n  const handleSearchForm = (data: EventFilterParamsType) =>\r\n    dispatch(loadListAsync(1, false, data));\r\n\r\n  useEffect(() => {\r\n    handleReloadList()\r\n  }, [dispatch]);\r\n\r\n  return {\r\n    eventList: { ...eventList, lastPage },\r\n    handleReloadList,\r\n    handleChangePagination,\r\n    handleNextPage,\r\n    handleSearchForm\r\n  };\r\n};","import React, { FC } from \"react\";\r\nimport { Switch, Route, useRouteMatch } from \"react-router-dom\";\r\n\r\nimport { ProfileEvents } from \"./Events/ProfileEvents\";\r\n\r\nexport const Profile: FC = () => {\r\n\r\n  const { path } = useRouteMatch();\r\n\r\n  return (\r\n    <div>\r\n      {/* Here is profile navigation */}\r\n\r\n      <Switch>\r\n        <Route path={`/profile/events`} component={ProfileEvents} />\r\n      </Switch>\r\n    </div>\r\n  )\r\n}","export const emailRegex = /^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;","import React, { useEffect } from \"react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { useForm } from \"react-hook-form\";\r\n\r\n// Types\r\nimport { RootState } from \"../../../../store/store\";\r\nimport { FormContextValues } from \"react-hook-form/dist/contextTypes\";\r\nimport { LoginFormType, LoginStateType } from \"../../../../store/login/types\";\r\n\r\n// Actions\r\nimport { loginAsync } from \"../../../../store/login/actions\";\r\n\r\nexport type HookLoginFormResponse = {\r\n  login: LoginStateType;\r\n  hookForm: FormContextValues<LoginFormType>;\r\n  onSubmit: (data: LoginFormType) => void;\r\n};\r\n\r\nexport const useLoginForm = (onCompleted?: () => void): HookLoginFormResponse => {\r\n  const dispatch = useDispatch();\r\n\r\n  const login = useSelector<RootState, LoginStateType>(state => state.login);\r\n  const hookForm = useForm<LoginFormType>();\r\n\r\n  const onSubmit = (data: LoginFormType) => {\r\n    dispatch(loginAsync(data));\r\n  }\r\n\r\n  useEffect(() => {\r\n    if (login.success && onCompleted) {\r\n      onCompleted();\r\n    }\r\n  }, [login.success]);\r\n\r\n  return {\r\n    login,\r\n    hookForm,\r\n    onSubmit\r\n  };\r\n};","import React, { FC } from \"react\";\r\nimport { Form, Button, FormControl, Alert } from \"react-bootstrap\";\r\nimport { emailRegex } from \"../../../regex\";\r\n\r\n// Types\r\nimport { useLoginForm } from \"./hooks/hookLoginForm\";\r\n\r\ntype PropTypes = {\r\n  onCompleted?: () => void;\r\n}\r\n\r\nexport const LoginForm: FC<PropTypes> = ({ onCompleted }: PropTypes) => {\r\n\r\n  const {\r\n    login: { loader, error },\r\n    hookForm: { register, errors, handleSubmit },\r\n    onSubmit\r\n  } = useLoginForm(onCompleted);\r\n\r\n  return (\r\n    <Form onSubmit={handleSubmit(onSubmit)}>\r\n      <Form.Group>\r\n        <Form.Label>Email <span className={'text-danger'}>*</span></Form.Label>\r\n        <Form.Control\r\n          type=\"text\"\r\n          name=\"email\"\r\n          ref={register<FormControl & HTMLInputElement>({\r\n            required: true,\r\n            pattern: emailRegex,\r\n            maxLength: 50\r\n          })}\r\n          isInvalid={!!errors.email}\r\n        />\r\n        <Form.Control.Feedback type={'invalid'}>Введите корректный email адрес</Form.Control.Feedback>\r\n      </Form.Group>\r\n\r\n      <Form.Group>\r\n        <Form.Label>Пароль <span className={'text-danger'}>*</span></Form.Label>\r\n        <Form.Control\r\n          type=\"password\"\r\n          name=\"password\"\r\n          ref={register<FormControl & HTMLInputElement>({\r\n            required: true,\r\n            maxLength: 50,\r\n            minLength: 5\r\n          })}\r\n          isInvalid={!!errors.password}\r\n        />\r\n        <Form.Control.Feedback type={'invalid'}>Введите пароль от 5 до 50 символов</Form.Control.Feedback>\r\n      </Form.Group>\r\n\r\n      {error ? <Alert variant=\"danger\">{error}</Alert> : null}\r\n\r\n      <div className=\"text-center\">\r\n        <Button disabled={loader} variant=\"primary\" type=\"submit\">\r\n          Войти\r\n        </Button>\r\n      </div>\r\n    </Form>\r\n  )\r\n}","import React, { FC } from \"react\";\r\nimport { Modal } from \"react-bootstrap\";\r\nimport { LoginForm } from \"./LoginForm\";\r\nimport { useLoginModal } from \"./hooks/hookLoginModal\";\r\n\r\nexport const Login: FC = () => {\r\n\r\n  const { isShowModal, handleCloseModal } = useLoginModal();\r\n\r\n  return (\r\n    <Modal show={isShowModal} onHide={handleCloseModal}>\r\n      <Modal.Header closeButton>\r\n        <Modal.Title>\r\n          Авторизация\r\n        </Modal.Title>\r\n      </Modal.Header>\r\n      <Modal.Body>\r\n        <LoginForm onCompleted={handleCloseModal} />\r\n      </Modal.Body>\r\n    </Modal>\r\n  )\r\n}","import React from \"react\";\r\nimport { useSelector, useDispatch } from \"react-redux\";\r\nimport { RootState } from \"../../../../store/store\";\r\nimport { LoginStateType } from \"../../../../store/login/types\";\r\nimport { hideModal } from \"../../../../store/login/actions\";\r\n\r\nexport const useLoginModal = () => {\r\n\r\n  const dispatch = useDispatch();\r\n  const { isShowModal } = useSelector<RootState, LoginStateType>(state => state.login);\r\n\r\n  const handleCloseModal = () => dispatch(hideModal());\r\n\r\n  return {\r\n    isShowModal,\r\n    handleCloseModal\r\n  }\r\n};","import { createAction } from \"@reduxjs/toolkit\";\r\nimport api from \"../../../../api\";\r\n\r\n// Types\r\nimport { EventType } from \"../../types\";\r\nimport { AppThunk } from \"../../../store\";\r\nimport { EventDetailStatuses } from \"./types\";\r\n\r\nexport const setDetail = createAction<EventType>('event-detail/set-detail');\r\nexport const setError = createAction<string>('event-detail/set-error');\r\nexport const setLoader = createAction<boolean>('event-detail/set-loader');\r\n\r\nexport const fetchDetailAsync = (id: number): AppThunk => async dispatch => {\r\n  dispatch(setLoader(true));\r\n\r\n  try {\r\n    const response = await api.public.events.detail(id);\r\n\r\n    if (response.status === EventDetailStatuses.success) {\r\n      dispatch(setDetail(response.detail));\r\n    } else {\r\n      dispatch(setError(response.message));\r\n    }\r\n  } catch (e) {\r\n    dispatch(setError(e.message));\r\n  } finally {\r\n    dispatch(setLoader(false));\r\n  }\r\n}","import React, { useEffect } from \"react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { RootState } from \"../../../../../store/store\";\r\nimport { EventDetailStateType } from \"../../../../../store/events/public/detail/types\";\r\nimport { fetchDetailAsync } from \"../../../../../store/events/public/detail/actions\";\r\nimport { useParams } from \"react-router-dom\";\r\nimport { RouteParamsType, StatusEvent } from \"../types\";\r\nimport { useEventItem } from \"../../../Profile/Events/hooks/hookEventItem\";\r\n\r\nexport type HookEventDetailType = EventDetailStateType;\r\n\r\nexport const useEventDetail = (): HookEventDetailType => {\r\n\r\n  const dispatch = useDispatch();\r\n  const { id } = useParams<RouteParamsType>();\r\n  const { loader, error, detail } = useSelector<RootState, EventDetailStateType>(state => state.publicEventDetail);\r\n\r\n  useEffect(() => {\r\n    dispatch(fetchDetailAsync(+id));\r\n  }, [dispatch]);\r\n\r\n  return {\r\n    loader,\r\n    error,\r\n    detail\r\n  };\r\n};","import React, { createRef, FC, useEffect, useState } from \"react\";\r\nimport L from \"leaflet\";\r\n\r\n// Styles\r\nimport \"leaflet/dist/leaflet.css\";\r\nimport 'leaflet.markercluster/dist/MarkerCluster.Default.css';\r\n\r\nexport type LeafletPropTypes = {\r\n  id: string;\r\n  onLoaded(map: L.Map): void;\r\n  options: L.MapOptions & {\r\n    center: [number, number],\r\n    zoom: number;\r\n  };\r\n}\r\n\r\nexport const Leaflet: FC<LeafletPropTypes> = (props: LeafletPropTypes) => {\r\n\r\n  const mapRef = createRef<HTMLDivElement>();\r\n  const [map, setMap] = useState<L.Map|undefined>(undefined);\r\n\r\n  useEffect(() => {\r\n    if (mapRef.current) {\r\n      const map = L.map(mapRef.current, props.options);\r\n\r\n      L.tileLayer(\r\n        'https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',\r\n        { attribution: '© OpenStreetMap contributors' }\r\n      ).addTo(map);\r\n\r\n      setMap(map);\r\n\r\n      props.onLoaded(map);\r\n    }\r\n  }, [1]);\r\n\r\n  useEffect(() => {\r\n    if (map) {\r\n      map.setView(\r\n        props.options.center,\r\n        props.options.zoom\r\n      );\r\n    }\r\n  }, [props.options]);\r\n\r\n  return (\r\n    <div id={props.id}>\r\n      <div ref={mapRef} />\r\n    </div>\r\n  )\r\n}","import { ComputeBoundsType, PointType } from \"./types\";\r\n\r\nexport const EARTH_RADIUS = 6378245;\r\n\r\nexport function deg2rad(degree: number): number {\r\n  return degree * (Math.PI / 180);\r\n}\r\n\r\nexport function rad2deg(degree: number): number {\r\n  return degree * (180 / Math.PI);\r\n}\r\n\r\n/**\r\n * @param {PointType} point\r\n * @param {number} distance - meters\r\n * @return {ComputeBoundsType}\r\n */\r\nexport function computeBounds({ lat, lng }: PointType, distance: number): ComputeBoundsType {\r\n  const latRadiansDistance = distance / EARTH_RADIUS;\r\n  const latDegreesDistance = rad2deg(latRadiansDistance);\r\n  const lngDegreesDistance = rad2deg(latRadiansDistance / Math.cos(deg2rad(lat)));\r\n\r\n  const swLat = lat - latDegreesDistance;\r\n  const swLng = lng - lngDegreesDistance;\r\n\r\n  const neLat = lat + latDegreesDistance;\r\n  const neLng = lng + lngDegreesDistance;\r\n\r\n  return {\r\n    from: { lat: swLat, lng: swLng },\r\n    to: { lat: neLat, lng: neLng }\r\n  };\r\n}\r\n\r\nexport function isPointBetweenPoints(point: PointType, points: ComputeBoundsType): boolean {\r\n  return (points.from.lat <= point.lat && points.from.lng <= point.lng) &&\r\n    (points.to.lat >= point.lat && points.to.lng >= point.lng);\r\n}","export enum SocketListenEvents {\r\n  SET_CONNECTIONS = 'map group connections',\r\n  ADD_CONNECTION = 'map new connection',\r\n  REMOVE_CONNECTION = 'map remove connection',\r\n  TOTAL_CONNECTIONS = 'total connection'\r\n}\r\n\r\nexport enum SocketEmitEvents {\r\n  GET_ALL_CONNECTIONS = 'map get all connections',\r\n  GET_TOTAL = 'get total'\r\n}","import socketInit from \"../../services/socket-io\";\r\nimport { SocketEmitEvents, SocketListenEvents } from \"./constants\";\r\nimport { ComputeBoundsType } from \"../../services/coords/types\";\r\nimport { PointUserType } from \"./types\";\r\nimport { EventType } from \"../../store/events/types\";\r\n\r\nexport const createQueryParams = (event: EventType) => ({\r\n  eventId: event.id,\r\n  duration: event.interval,\r\n  finishedAt: event.finishAt,\r\n  startAt: event.startAt,\r\n  timezone: event.timezoneUTC\r\n});\r\n\r\nexport const createSocket = (event: EventType): SocketIOClient.Socket => {\r\n  return socketInit(createQueryParams(event));\r\n}\r\n\r\nexport function connectWebsocket(\r\n  socket: SocketIOClient.Socket,\r\n  borders: ComputeBoundsType,\r\n  setConnection: (connections: PointUserType[]) => void,\r\n  addPlacement: (connection: PointUserType) => void,\r\n  removePlacement: (connection: PointUserType) => void,\r\n  setTotalConnections?: (total: number) => void\r\n) {\r\n  socket.emit(SocketEmitEvents.GET_TOTAL);\r\n  socket.emit(SocketEmitEvents.GET_ALL_CONNECTIONS, borders);\r\n\r\n  if (setTotalConnections) {\r\n    socket.on(SocketListenEvents.TOTAL_CONNECTIONS, setTotalConnections);\r\n  }\r\n\r\n  socket.on(SocketListenEvents.ADD_CONNECTION, addPlacement);\r\n  socket.on(SocketListenEvents.REMOVE_CONNECTION, removePlacement);\r\n  socket.on(SocketListenEvents.SET_CONNECTIONS, setConnection);\r\n\r\n  socket.on('warn', (message: string) => console.log('Error', message));\r\n}\r\n\r\nexport function leave(socket: SocketIOClient.Socket): void {\r\n  socket.off(SocketListenEvents.ADD_CONNECTION);\r\n  socket.off(SocketListenEvents.REMOVE_CONNECTION);\r\n  socket.off(SocketListenEvents.SET_CONNECTIONS);\r\n  socket.off(SocketListenEvents.TOTAL_CONNECTIONS);\r\n  socket.off('warn');\r\n}","import io from 'socket.io-client';\r\n\r\nexport default function socket(queryParams?: Object) {\r\n  return io(process.env.REACT_APP_WEBSOCKET_URL || 'http://localhost:9001', {\r\n    rememberUpgrade: true,\r\n    transports: ['websocket'],\r\n    secure: true,\r\n    rejectUnauthorized: false,\r\n    query: queryParams\r\n  });\r\n}","import React, { useState, useEffect } from \"react\";\r\nimport { EventType } from \"../../store/events/types\";\r\nimport { createSocket, leave } from \"./websocket\";\r\n\r\nexport const useMap = <M>(event: EventType, subscribeSockets: (objectManager: M) => void): [\r\n  M|undefined,\r\n  (objectManager: M|undefined) => void,\r\n  SocketIOClient.Socket\r\n] => {\r\n  const [socket, setSocket] = useState<SocketIOClient.Socket>(createSocket(event));\r\n  const [objectManager, setObjectManager] = useState<M|undefined>(undefined);\r\n\r\n  useEffect(() => {\r\n    if (objectManager) {\r\n      subscribeSockets(objectManager);\r\n    }\r\n  }, [objectManager]);\r\n\r\n  useEffect(() => {\r\n    return function cleanup() {\r\n      leave(socket);\r\n      socket.disconnect();\r\n    }\r\n  }, [socket]);\r\n\r\n  return [\r\n    objectManager,\r\n    setObjectManager,\r\n    socket\r\n  ];\r\n};","import React, { FC, useEffect } from \"react\";\r\nimport L from \"leaflet\";\r\nimport \"leaflet.markercluster\";\r\nimport { Leaflet } from \"./Leaflet\";\r\nimport { computeBounds, isPointBetweenPoints } from \"../../services/coords/coords\";\r\nimport { useMap } from \"./hookMap\";\r\nimport { connectWebsocket } from \"./websocket\";\r\n\r\n// Types\r\nimport {\r\n  AttachEventsType,\r\n  PointUserType,\r\n  PropTypes\r\n} from \"./types\";\r\n\r\ntype StorageMarkersType = {\r\n  [index in string]: L.Marker;\r\n}\r\n\r\n// Default icon\r\nconst icon = L.icon({\r\n  iconUrl: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAApCAYAAADAk4LOAAAFgUlEQVR4Aa1XA5BjWRTN2oW17d3YaZtr2962HUzbDNpjszW24mRt28p47v7zq/bXZtrp/lWnXr337j3nPCe85NcypgSFdugCpW5YoDAMRaIMqRi6aKq5E3YqDQO3qAwjVWrD8Ncq/RBpykd8oZUb/kaJutow8r1aP9II0WmLKLIsJyv1w/kqw9Ch2MYdB++12Onxee/QMwvf4/Dk/Lfp/i4nxTXtOoQ4pW5Aj7wpici1A9erdAN2OH64x8OSP9j3Ft3b7aWkTg/Fm91siTra0f9on5sQr9INejH6CUUUpavjFNq1B+Oadhxmnfa8RfEmN8VNAsQhPqF55xHkMzz3jSmChWU6f7/XZKNH+9+hBLOHYozuKQPxyMPUKkrX/K0uWnfFaJGS1QPRtZsOPtr3NsW0uyh6NNCOkU3Yz+bXbT3I8G3xE5EXLXtCXbbqwCO9zPQYPRTZ5vIDXD7U+w7rFDEoUUf7ibHIR4y6bLVPXrz8JVZEql13trxwue/uDivd3fkWRbS6/IA2bID4uk0UpF1N8qLlbBlXs4Ee7HLTfV1j54APvODnSfOWBqtKVvjgLKzF5YdEk5ewRkGlK0i33Eofffc7HT56jD7/6U+qH3Cx7SBLNntH5YIPvODnyfIXZYRVDPqgHtLs5ABHD3YzLuespb7t79FY34DjMwrVrcTuwlT55YMPvOBnRrJ4VXTdNnYug5ucHLBjEpt30701A3Ts+HEa73u6dT3FNWwflY86eMHPk+Yu+i6pzUpRrW7SNDg5JHR4KapmM5Wv2E8Tfcb1HoqqHMHU+uWDD7zg54mz5/2BSnizi9T1Dg4QQXLToGNCkb6tb1NU+QAlGr1++eADrzhn/u8Q2YZhQVlZ5+CAOtqfbhmaUCS1ezNFVm2imDbPmPng5wmz+gwh+oHDce0eUtQ6OGDIyR0uUhUsoO3vfDmmgOezH0mZN59x7MBi++WDL1g/eEiU3avlidO671bkLfwbw5XV2P8Pzo0ydy4t2/0eu33xYSOMOD8hTf4CrBtGMSoXfPLchX+J0ruSePw3LZeK0juPJbYzrhkH0io7B3k164hiGvawhOKMLkrQLyVpZg8rHFW7E2uHOL888IBPlNZ1FPzstSJM694fWr6RwpvcJK60+0HCILTBzZLFNdtAzJaohze60T8qBzyh5ZuOg5e7uwQppofEmf2++DYvmySqGBuKaicF1blQjhuHdvCIMvp8whTTfZzI7RldpwtSzL+F1+wkdZ2TBOW2gIF88PBTzD/gpeREAMEbxnJcaJHNHrpzji0gQCS6hdkEeYt9DF/2qPcEC8RM28Hwmr3sdNyht00byAut2k3gufWNtgtOEOFGUwcXWNDbdNbpgBGxEvKkOQsxivJx33iow0Vw5S6SVTrpVq11ysA2Rp7gTfPfktc6zhtXBBC+adRLshf6sG2RfHPZ5EAc4sVZ83yCN00Fk/4kggu40ZTvIEm5g24qtU4KjBrx/BTTH8ifVASAG7gKrnWxJDcU7x8X6Ecczhm3o6YicvsLXWfh3Ch1W0k8x0nXF+0fFxgt4phz8QvypiwCCFKMqXCnqXExjq10beH+UUA7+nG6mdG/Pu0f3LgFcGrl2s0kNNjpmoJ9o4B29CMO8dMT4Q5ox8uitF6fqsrJOr8qnwNbRzv6hSnG5wP+64C7h9lp30hKNtKdWjtdkbuPA19nJ7Tz3zR/ibgARbhb4AlhavcBebmTHcFl2fvYEnW0ox9xMxKBS8btJ+KiEbq9zA4RthQXDhPa0T9TEe69gWupwc6uBUphquXgf+/FrIjweHQS4/pduMe5ERUMHUd9xv8ZR98CxkS4F2n3EUrUZ10EYNw7BWm9x1GiPssi3GgiGRDKWRYZfXlON+dfNbM+GgIwYdwAAAAASUVORK5CYII='\r\n});\r\n\r\nlet storageMarkers: StorageMarkersType = {};\r\n\r\nexport const Map: FC<PropTypes> = ({ event, onSetTotal }: PropTypes) => {\r\n\r\n  const [cluster, setCluster, socket] = useMap<L.MarkerClusterGroup>(event, () => {\r\n    attachEvents(\r\n      event,\r\n      socket,\r\n      handlerAddMarkers,\r\n      handlerRemoveMarker,\r\n      onSetTotal\r\n    );\r\n  });\r\n\r\n  const handlerAddMarkers = (markers: L.Marker[]) => {\r\n    if (cluster) {\r\n      cluster.addLayers(markers);\r\n    }\r\n  };\r\n\r\n  const handlerRemoveMarker = (point: PointUserType) => {\r\n    if (cluster && storageMarkers[point.id]) {\r\n      cluster.removeLayer(storageMarkers[point.id]);\r\n      delete storageMarkers[point.id];\r\n    }\r\n  };\r\n\r\n  const onLoadedMap = (map: L.Map) => {\r\n    const managerObject = L.markerClusterGroup({\r\n      maxClusterRadius: 300,\r\n      chunkDelay: 300,\r\n      chunkInterval: 300,\r\n      chunkedLoading: true,\r\n      zoomToBoundsOnClick: false,\r\n      spiderfyOnMaxZoom: false,\r\n      showCoverageOnHover: false,\r\n    });\r\n\r\n    map.addLayer(managerObject);\r\n    map.setMaxZoom(10);\r\n\r\n    setCluster(managerObject);\r\n  }\r\n\r\n  const { region: { lat, lng } } = event;\r\n\r\n  return (\r\n    <Leaflet\r\n      id={'app-map'}\r\n      onLoaded={onLoadedMap}\r\n      options={{\r\n        center: [lat, lng],\r\n        zoom: 8\r\n      }}\r\n    />\r\n  )\r\n};\r\n\r\nconst attachEvents: AttachEventsType<L.Marker[]> = (event, socket, add, remove, setTotal) => {\r\n  const { region: { lat, lng, distance } } = event;\r\n\r\n  const borders = computeBounds({ lat, lng }, distance);\r\n\r\n  const setConnection = (connections: PointUserType[]) => {\r\n    const markers = connections.map(point => createMarker(point))\r\n    add(markers);\r\n  };\r\n\r\n  const addPlacement = (connection: PointUserType) => {\r\n    if (isPointBetweenPoints(connection, borders)) {\r\n      add([createMarker(connection)]);\r\n    }\r\n  };\r\n\r\n  const removePlacement = (connection: PointUserType) => {\r\n    if (isPointBetweenPoints(connection, borders)) {\r\n      remove(connection);\r\n    }\r\n  };\r\n\r\n  connectWebsocket(\r\n    socket,\r\n    borders,\r\n    setConnection,\r\n    addPlacement,\r\n    removePlacement,\r\n    setTotal\r\n  );\r\n}\r\n\r\nconst createMarker = ({ lat, lng, id }: PointUserType): L.Marker => {\r\n  const marker = L.marker({ lat, lng }, { icon });\r\n  storageMarkers[id] = marker;\r\n  return marker;\r\n}","import { createAction } from \"@reduxjs/toolkit\";\r\nimport { EventStatisticType } from \"./types\";\r\nimport { AppThunk } from \"../store\";\r\nimport api from \"../../api\";\r\n\r\nexport const setLoader = createAction<boolean>('event-stat/set-loader');\r\nexport const setStat = createAction<EventStatisticType[]>('event-stat/set-list');\r\nexport const setError = createAction<string>('event-stat/set-error');\r\nexport const setMaxResult = createAction<number>('event-stat/set-max-result');\r\n\r\nexport const fetchEventStatAsync = (eventId: number): AppThunk => async dispatch => {\r\n  dispatch(setLoader(true));\r\n\r\n  try {\r\n    const rows: EventStatisticType[] = await api.public.events.stat(eventId);\r\n    const maxResult = Math.max(...rows.map(row => row.total));\r\n    dispatch(setStat(rows));\r\n    dispatch(setMaxResult(maxResult));\r\n  } catch (e) {\r\n    dispatch(setError(e.message));\r\n  } finally {\r\n    dispatch(setLoader(false));\r\n  }\r\n}","import React, { useEffect, useState } from \"react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport moment from \"../../../../../../services/moment\";\r\n\r\n// Types\r\nimport { RootState } from \"../../../../../../store/store\";\r\nimport { EventType } from \"../../../../../../store/events/types\";\r\nimport { EventStatisticStateType } from \"../../../../../../store/eventStatistic/types\";\r\n\r\n// Actions\r\nimport { fetchEventStatAsync, setStat } from \"../../../../../../store/eventStatistic/actions\";\r\n\r\nexport const useEventChart = ({ id, timezoneUTC }: EventType): EventStatisticStateType & {\r\n  chartData: Array<object>\r\n} => {\r\n\r\n  const dispatch = useDispatch();\r\n  const stat = useSelector<RootState, EventStatisticStateType>(state => state.eventStat);\r\n  const [chartData, setChartData] = useState<Array<object>>([])\r\n\r\n  useEffect(() => {\r\n    dispatch(fetchEventStatAsync(id));\r\n  }, [dispatch]);\r\n\r\n  useEffect(() => {\r\n    if (stat.rows.length > 0) {\r\n      setChartData(stat.rows.map(row => {\r\n        return {\r\n          ...row,\r\n          name: moment(row.createdAt).utcOffset(timezoneUTC).format('HH:mm')\r\n        }\r\n      }));\r\n    }\r\n\r\n    return function cleanup() {\r\n      dispatch(setStat([]));\r\n    }\r\n  }, [stat.rows.length])\r\n\r\n  return {\r\n    ...stat,\r\n    chartData\r\n  };\r\n}","import React, { FC } from \"react\";\r\nimport { Spinner, Alert } from \"react-bootstrap\";\r\nimport { LineChart, Line, XAxis, YAxis, ResponsiveContainer } from 'recharts';\r\nimport { EventType } from \"../../../../../store/events/types\";\r\nimport { useEventChart } from \"./hooks/hookEventChart\";\r\n\r\ntype PropTypes = {\r\n  event: EventType\r\n}\r\n\r\nexport const EventChart: FC<PropTypes> = ({ event }: PropTypes) => {\r\n\r\n  const { loader, totalMax, error, chartData } = useEventChart(event);\r\n\r\n  if (loader) {\r\n    return <Spinner animation=\"border\" variant=\"warning\" />\r\n  }\r\n\r\n  if (error) {\r\n    return <Alert variant=\"danger\">{error}</Alert>\r\n  }\r\n\r\n  if (!chartData.length) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      <p className=\"lead mb-5\">\r\n        Максимальное кол-во участников: <b>{totalMax}</b>\r\n      </p>\r\n\r\n      <ResponsiveContainer width={'100%'} aspect={4.0/1.5}>\r\n        <LineChart data={chartData}>\r\n          <Line type=\"monotone\" dataKey=\"total\" stroke=\"#8884d8\" />\r\n          <XAxis dataKey=\"name\" />\r\n          <YAxis />\r\n        </LineChart>\r\n      </ResponsiveContainer>\r\n    </div>\r\n  )\r\n}","import React, { FC } from \"react\";\r\nimport { useEventDetailStatus } from \"./hooks/hookEventDetailStatus\";\r\n\r\n// Components\r\nimport { EventWaiting } from \"./Waiting/EventWaiting\";\r\nimport { EventStarting } from \"./Starting/EventStarting\";\r\nimport { EventFinished } from \"./Finished/EventFinished\";\r\n\r\n// Types\r\nimport { EventType } from \"../../../../store/events/types\";\r\nimport { ConfigType } from \"./types\";\r\n\r\ntype PropTypes = {\r\n  event: EventType;\r\n}\r\n\r\nconst config: ConfigType = {\r\n  waiting: EventWaiting,\r\n  starting: EventStarting,\r\n  finished: EventFinished\r\n};\r\n\r\nexport const EventDetailWrapper: FC<PropTypes> = ({ event }: PropTypes) => {\r\n  const { status, timeToMeeting, timeToFinish } = useEventDetailStatus(event);\r\n  const Component = config[status];\r\n\r\n  return (\r\n    <>\r\n      <h2 className=\"mb-4\">{event.title}</h2>\r\n\r\n      <p className=\"lead mb-4\">{event.description}</p>\r\n\r\n      <Component\r\n        event={event}\r\n        timeToMeeting={timeToMeeting}\r\n        timeToFinish={timeToFinish}\r\n      />\r\n    </>\r\n  );\r\n}","import React, { FC } from \"react\";\r\nimport { EventPropTypes } from \"../types\";\r\n\r\nexport const EventWaiting: FC<EventPropTypes> = ({ timeToMeeting }: EventPropTypes) => {\r\n  return (\r\n    <div className=\"h3 mt-5 mb-3 text-success\">\r\n      Митинг начнется {timeToMeeting.toLowerCase()}\r\n    </div>\r\n  )\r\n}","import React, { FC, useState } from \"react\";\r\nimport { EventPropTypes } from \"../types\";\r\nimport { Card, Col, Row } from \"react-bootstrap\";\r\n\r\nimport { Map } from \"../../../../Map/LeafletMap\";\r\n\r\nexport const EventStarting: FC<EventPropTypes> = ({ event, timeToFinish }: EventPropTypes) => {\r\n\r\n  const [total, setTotal] = useState<number>(0)\r\n\r\n  return (\r\n    <div>\r\n      <Row className=\"justify-content-between\">\r\n        <Col md=\"auto\">\r\n          <p>Кол-во участников: {total}</p>\r\n        </Col>\r\n        <Col md=\"auto\">\r\n          <p>Окончание митинга {timeToFinish}</p>\r\n        </Col>\r\n      </Row>\r\n\r\n      <Card className=\"depth-1\">\r\n        <Map\r\n          event={event}\r\n          onSetTotal={setTotal}\r\n        />\r\n      </Card>\r\n    </div>\r\n  );\r\n};","import React, { FC } from \"react\";\r\nimport { EventPropTypes } from \"../types\";\r\nimport moment from \"../../../../../services/moment\";\r\nimport { EventChart } from \"./EventChart\";\r\n\r\nexport const EventFinished: FC<EventPropTypes> = ({ event }: EventPropTypes) => {\r\n\r\n  const finishDate = moment(event.finishAt)\r\n    .utcOffset(event.timezoneUTC)\r\n    .format('в HH:mm, Do MMM YYYY')\r\n\r\n  return (\r\n    <div>\r\n      <p className=\"lead\">\r\n        Митинг заканчился {finishDate}\r\n      </p>\r\n\r\n      <EventChart event={event} />\r\n    </div>\r\n  )\r\n}","import React from \"react\";\r\nimport { useEventItem } from \"../../../Profile/Events/hooks/hookEventItem\";\r\n\r\n// Types\r\nimport { StatusType } from \"../types\";\r\nimport { EventType } from \"../../../../../store/events/types\";\r\n\r\nexport type HookEventDetailStatusType = {\r\n  status: StatusType;\r\n  isStarted: boolean;\r\n  isFinished: boolean;\r\n  timeToMeeting: string;\r\n  timeToFinish: string;\r\n};\r\n\r\nexport const useEventDetailStatus = (item: EventType): HookEventDetailStatusType => {\r\n\r\n  const { isStarted, isFinished, timeToMeeting, timeToFinish } = useEventItem(item);\r\n\r\n  let status: StatusType = 'waiting';\r\n\r\n  if (isStarted && !isFinished) {\r\n    status = 'starting';\r\n  } else if (isFinished) {\r\n    status = 'finished';\r\n  }\r\n\r\n  return {\r\n    status,\r\n    isStarted,\r\n    isFinished,\r\n    timeToMeeting,\r\n    timeToFinish\r\n  };\r\n};","import React, { FC } from \"react\";\r\nimport { Spinner, Alert } from \"react-bootstrap\";\r\nimport { useEventDetail } from \"./hooks/hookEventDetail\";\r\n\r\nimport { EventDetailWrapper } from \"./EventDetailWrapper\";\r\nimport { Content } from \"../../../Layouts/Content\";\r\n\r\nexport const EventDetail: FC = () => {\r\n\r\n  const { detail, loader, error } = useEventDetail();\r\n\r\n  if (error) {\r\n    return <Alert variant=\"danger\">{error}</Alert>;\r\n  }\r\n\r\n  if (loader || !detail) {\r\n    return <Spinner animation=\"border\" variant=\"primary\" />;\r\n  }\r\n\r\n  return (\r\n    <Content>\r\n      <EventDetailWrapper event={detail} />\r\n    </Content>\r\n  );\r\n};","import React, { FC, useEffect }  from \"react\";\r\nimport \"./style/main.scss\";\r\nimport { useSelector, useDispatch } from \"react-redux\";\r\nimport { BrowserRouter, Switch, Route } from \"react-router-dom\";\r\nimport { autoLoginAsync } from \"./store/login/actions\";\r\n\r\n// Types\r\nimport { RootState } from \"./store/store\";\r\nimport { UserStateType } from \"./store/user/types\";\r\n\r\n// Layouts\r\nimport { SideBar } from \"./components/Layouts/SideBar\";\r\nimport { Menu } from \"./components/Layouts/Menu\";\r\n\r\n// Routing\r\nimport { Home } from \"./components/Pages/Home/Home\";\r\nimport { EventList } from \"./components/Pages/Events/List/EventList\";\r\nimport { AboutUs } from \"./components/Pages/AboutUs/AboutUs\";\r\nimport { Profile } from \"./components/Pages/Profile/Profile\";\r\nimport { Login } from \"./components/Auth/Login/Login\";\r\nimport { EventDetail } from \"./components/Pages/Events/Detail/EventDetail\";\r\n\r\nexport const App: FC = () => {\r\n\r\n  const dispatch = useDispatch();\r\n\r\n  useEffect(() => {\r\n    dispatch(autoLoginAsync());\r\n  }, [dispatch]);\r\n\r\n  const { user } = useSelector<RootState, UserStateType>(state => state.user);\r\n\r\n  return (\r\n    <BrowserRouter>\r\n      <main>\r\n        <SideBar />\r\n\r\n        <Login />\r\n\r\n        <div id=\"content\" className=\"px-md-5 pb-md-5\">\r\n          <Menu />\r\n\r\n          <Switch>\r\n            <Route path={'/'} exact component={Home} />\r\n            <Route path={'/events'} exact component={EventList} />\r\n            <Route path={'/events/:id'} component={EventDetail} />\r\n            <Route path={'/about'} exact component={AboutUs} />\r\n            {user ? (\r\n              <Route path={'/profile'} component={Profile} />\r\n            ) : null}\r\n          </Switch>\r\n        </div>\r\n      </main>\r\n    </BrowserRouter>\r\n  )\r\n};\r\n","import { createReducer, PayloadAction } from \"@reduxjs/toolkit\";\r\n\r\n// Actions\r\nimport * as regionListActions from \"./actions\";\r\n\r\n// Types\r\nimport { RegionsStateType } from \"./types\";\r\nimport { RegionType } from \"../types\";\r\n\r\nconst initialState: RegionsStateType = {\r\n  fetchLoader: false,\r\n  regions: []\r\n};\r\n\r\nexport default createReducer(initialState, {\r\n  [regionListActions.setLoader.type]: (state: RegionsStateType, action: PayloadAction<boolean>): void => {\r\n    state.fetchLoader = action.payload;\r\n  },\r\n  [regionListActions.setList.type]: (state: RegionsStateType, action: PayloadAction<RegionType[]>): void => {\r\n    state.regions = action.payload;\r\n  }\r\n});","import { createReducer, PayloadAction } from \"@reduxjs/toolkit\";\r\n\r\n// Actions\r\nimport * as regionActions from \"./actions\";\r\n\r\n// Types\r\nimport { RegionStateType } from \"./types\";\r\nimport { RegionType } from \"../types\";\r\n\r\nconst initialState: RegionStateType = {\r\n  region: null\r\n};\r\n\r\nexport default createReducer(initialState, {\r\n  [regionActions.setItem.type]: (state: RegionStateType, action: PayloadAction<RegionType>): void => {\r\n    state.region = action.payload;\r\n  }\r\n});","import { createReducer, PayloadAction } from \"@reduxjs/toolkit\";\r\nimport * as userActions from \"./actions\";\r\nimport { UserStateType, UserType } from \"./types\";\r\n\r\nconst initialState: UserStateType = {\r\n  user: null,\r\n  token: null,\r\n  expired: null,\r\n}\r\n\r\nexport default createReducer(initialState, {\r\n  [userActions.setUser.type]: (state: UserStateType, action: PayloadAction<UserType>) => {\r\n    state.user = action.payload.user;\r\n    state.token = action.payload.token;\r\n    state.expired = action.payload.expired;\r\n  },\r\n  [userActions.clearUser.type]: (state: UserStateType) => {\r\n    state.user = null;\r\n    state.token = null;\r\n    state.expired = null;\r\n  }\r\n});","import { createReducer, PayloadAction } from \"@reduxjs/toolkit\";\r\nimport * as loginActions from \"./actions\";\r\nimport { LoginStateType } from \"./types\";\r\n\r\nconst initialState: LoginStateType = {\r\n  loader: false,\r\n  error: null,\r\n  success: null,\r\n  isShowModal: false\r\n}\r\n\r\nexport default createReducer(initialState, {\r\n  [loginActions.setLoader.type]: (state: LoginStateType, action: PayloadAction<boolean>) => {\r\n    state.loader = action.payload;\r\n  },\r\n  [loginActions.setError.type]: (state: LoginStateType, action: PayloadAction<string|null>) => {\r\n    state.error = action.payload;\r\n  },\r\n  [loginActions.setSuccess.type]: (state: LoginStateType, action: PayloadAction<string|null>) => {\r\n    state.success = action.payload;\r\n  },\r\n  [loginActions.showModal.type]: (state: LoginStateType) => {\r\n    state.isShowModal = true;\r\n  },\r\n  [loginActions.hideModal.type]: (state: LoginStateType) => {\r\n    state.isShowModal = false;\r\n  }\r\n});","import { createReducer, PayloadAction } from \"@reduxjs/toolkit\";\r\nimport { EventStatisticStateType, EventStatisticType } from \"./types\";\r\nimport * as eventStatActions from \"./actions\";\r\n\r\nconst initialState: EventStatisticStateType = {\r\n  rows: [],\r\n  loader: false,\r\n  totalMax: 0,\r\n  error: null,\r\n}\r\n\r\nexport default createReducer(initialState, {\r\n  [eventStatActions.setStat.type]: (state: EventStatisticStateType, action: PayloadAction<EventStatisticType[]>) => {\r\n    state.error = null;\r\n    state.rows = action.payload;\r\n  },\r\n  [eventStatActions.setError.type]: (state: EventStatisticStateType, action: PayloadAction<string>) => {\r\n    state.error = action.payload;\r\n  },\r\n  [eventStatActions.setLoader.type]: (state: EventStatisticStateType, action: PayloadAction<boolean>) => {\r\n    state.loader = action.payload;\r\n  },\r\n  [eventStatActions.setMaxResult.type]: (state: EventStatisticStateType, action: PayloadAction<number>) => {\r\n    state.totalMax = action.payload;\r\n  },\r\n});","import { createReducer, PayloadAction } from \"@reduxjs/toolkit\";\r\nimport { EventFilterParamsType, EventListStateType, EventListType } from \"./types\";\r\nimport * as eventListActions from \"./actions\";\r\n\r\nconst initialState: EventListStateType = {\r\n  loader: false,\r\n  error: null,\r\n  items: [],\r\n  total: 0,\r\n  currentPage: 1,\r\n  perPage: 0,\r\n  form: {}\r\n};\r\n\r\nexport default createReducer(initialState, {\r\n  [eventListActions.setLoader.type]: (state: EventListStateType, action: PayloadAction<boolean>) => {\r\n    state.loader = action.payload;\r\n  },\r\n  [eventListActions.setError.type]: (state: EventListStateType, action: PayloadAction<string>) => {\r\n    state.error = action.payload;\r\n  },\r\n  [eventListActions.setToList.type]: (state: EventListStateType, action: PayloadAction<EventListType>) => {\r\n    state.items = action.payload.items;\r\n    state.currentPage = action.payload.currentPage;\r\n    state.perPage = action.payload.perPage;\r\n    state.total = action.payload.total;\r\n  },\r\n  [eventListActions.addToList.type]: (state: EventListStateType, action: PayloadAction<EventListType>) => {\r\n    state.items = state.items.concat(action.payload.items);\r\n    state.currentPage = action.payload.currentPage;\r\n    state.perPage = action.payload.perPage;\r\n    state.total = action.payload.total;\r\n  },\r\n  [eventListActions.setSearchForm.type]: (state: EventListStateType, action: PayloadAction<EventFilterParamsType>) => {\r\n    state.form = {...action.payload};\r\n  }\r\n});","import { createReducer, PayloadAction } from \"@reduxjs/toolkit\";\r\nimport { EventPublicListStateType, EventPublicListType } from \"./types\";\r\nimport * as eventListActions from \"./actions\";\r\n\r\nconst initialState: EventPublicListStateType = {\r\n  total: 0,\r\n  items: [],\r\n  currentPage: 1,\r\n  perPage: 0,\r\n  loader: false,\r\n  error: null\r\n}\r\n\r\nexport default createReducer(initialState, {\r\n  [eventListActions.setLoader.type]: (state: EventPublicListStateType, action: PayloadAction<boolean>) => {\r\n    state.loader = action.payload;\r\n  },\r\n  [eventListActions.setError.type]: (state: EventPublicListStateType, action: PayloadAction<string>) => {\r\n    state.error = action.payload;\r\n  },\r\n  [eventListActions.setToList.type]: (state: EventPublicListStateType, action: PayloadAction<EventPublicListType>) => {\r\n    state.items = action.payload.items;\r\n    state.currentPage = action.payload.currentPage;\r\n    state.perPage = action.payload.perPage;\r\n    state.total = action.payload.total;\r\n  },\r\n  [eventListActions.addToList.type]: (state: EventPublicListStateType, action: PayloadAction<EventPublicListType>) => {\r\n    state.items = state.items.concat(action.payload.items);\r\n    state.currentPage = action.payload.currentPage;\r\n    state.perPage = action.payload.perPage;\r\n    state.total = action.payload.total;\r\n  }\r\n})","import { createReducer, PayloadAction } from \"@reduxjs/toolkit\";\r\nimport * as eventDetailActions from \"./actions\";\r\n\r\nimport { EventDetailStateType } from \"./types\";\r\nimport { EventType } from \"../../types\";\r\n\r\nconst initialState: EventDetailStateType = {\r\n  loader: false,\r\n  detail: null,\r\n  error: null\r\n};\r\n\r\nexport default createReducer(initialState, {\r\n  [eventDetailActions.setDetail.type]: (state: EventDetailStateType, action: PayloadAction<EventType>) => {\r\n    state.error = null;\r\n    state.detail = action.payload;\r\n  },\r\n  [eventDetailActions.setError.type]: (state: EventDetailStateType, action: PayloadAction<string>) => {\r\n    state.error = action.payload;\r\n    state.detail = null;\r\n  },\r\n  [eventDetailActions.setLoader.type]: (state: EventDetailStateType, action: PayloadAction<boolean>) => {\r\n    state.loader = action.payload;\r\n  },\r\n});","import { combineReducers } from \"@reduxjs/toolkit\";\r\n\r\nimport { region, regions } from \"./regions\";\r\nimport user from \"./user/reducer\";\r\nimport login from \"./login/reducer\";\r\nimport { eventStat } from \"./eventStatistic\";\r\nimport {\r\n  profileEventList,\r\n  publicEventList,\r\n  publicEventDetail\r\n} from \"./events\";\r\n\r\nexport default combineReducers({\r\n  region,\r\n  regions,\r\n  user,\r\n  login,\r\n  profileEventList,\r\n  publicEventList,\r\n  publicEventDetail,\r\n  eventStat\r\n});","import { createLogger } from \"redux-logger\";\r\nimport { getDefaultMiddleware } from \"@reduxjs/toolkit\";\r\nimport { Middleware } from \"redux\";\r\n\r\nexport const logger = createLogger({\r\n  duration: true,\r\n  collapsed: true\r\n});\r\n\r\nconst development = process.env.NODE_ENV === 'development';\r\n\r\nconst middleware: Middleware[] = [...getDefaultMiddleware()];\r\n\r\nif (development) {\r\n  middleware.push(logger)\r\n}\r\n\r\nexport { middleware }\r\n","import { configureStore, ThunkAction, Action } from \"@reduxjs/toolkit\";\r\nimport reducer from \"./rootReducer\";\r\nimport { middleware } from \"./middleware\";\r\n\r\nexport const store = configureStore({\r\n  reducer,\r\n  middleware\r\n});\r\n\r\nexport type RootState = ReturnType<typeof reducer>\r\n\r\nexport type AppThunk<ReturnType = void> = ThunkAction<\r\n  ReturnType,\r\n  RootState,\r\n  unknown,\r\n  Action<string>\r\n>","// This optional code is used to register a service worker.\r\n// register() is not called by default.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on subsequent visits to a page, after all the\r\n// existing tabs open on the page have been closed, since previously cached\r\n// resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model and instructions on how to\r\n// opt-in, read https://bit.ly/CRA-PWA\r\n\r\nconst isLocalhost = Boolean(\r\n  window.location.hostname === 'localhost' ||\r\n    // [::1] is the IPv6 localhost address.\r\n    window.location.hostname === '[::1]' ||\r\n    // 127.0.0.0/8 are considered localhost for IPv4.\r\n    window.location.hostname.match(\r\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\r\n    )\r\n);\r\n\r\ntype Config = {\r\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\r\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\r\n};\r\n\r\nexport function register(config?: Config) {\r\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\r\n    // The URL constructor is available in all browsers that support SW.\r\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\r\n    if (publicUrl.origin !== window.location.origin) {\r\n      // Our service worker won't work if PUBLIC_URL is on a different origin\r\n      // from what our page is served on. This might happen if a CDN is used to\r\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\r\n      return;\r\n    }\r\n\r\n    window.addEventListener('load', () => {\r\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\r\n\r\n      if (isLocalhost) {\r\n        // This is running on localhost. Let's check if a service worker still exists or not.\r\n        checkValidServiceWorker(swUrl, config);\r\n\r\n        // Add some additional logging to localhost, pointing developers to the\r\n        // service worker/PWA documentation.\r\n        navigator.serviceWorker.ready.then(() => {\r\n          console.log(\r\n            'This web app is being served cache-first by a service ' +\r\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\r\n          );\r\n        });\r\n      } else {\r\n        // Is not localhost. Just register service worker\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nfunction registerValidSW(swUrl: string, config?: Config) {\r\n  navigator.serviceWorker\r\n    .register(swUrl)\r\n    .then(registration => {\r\n      registration.onupdatefound = () => {\r\n        const installingWorker = registration.installing;\r\n        if (installingWorker == null) {\r\n          return;\r\n        }\r\n        installingWorker.onstatechange = () => {\r\n          if (installingWorker.state === 'installed') {\r\n            if (navigator.serviceWorker.controller) {\r\n              // At this point, the updated precached content has been fetched,\r\n              // but the previous service worker will still serve the older\r\n              // content until all client tabs are closed.\r\n              console.log(\r\n                'New content is available and will be used when all ' +\r\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\r\n              );\r\n\r\n              // Execute callback\r\n              if (config && config.onUpdate) {\r\n                config.onUpdate(registration);\r\n              }\r\n            } else {\r\n              // At this point, everything has been precached.\r\n              // It's the perfect time to display a\r\n              // \"Content is cached for offline use.\" message.\r\n              console.log('Content is cached for offline use.');\r\n\r\n              // Execute callback\r\n              if (config && config.onSuccess) {\r\n                config.onSuccess(registration);\r\n              }\r\n            }\r\n          }\r\n        };\r\n      };\r\n    })\r\n    .catch(error => {\r\n      console.error('Error during service worker registration:', error);\r\n    });\r\n}\r\n\r\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\r\n  // Check if the service worker can be found. If it can't reload the page.\r\n  fetch(swUrl, {\r\n    headers: { 'Service-Worker': 'script' },\r\n  })\r\n    .then(response => {\r\n      // Ensure service worker exists, and that we really are getting a JS file.\r\n      const contentType = response.headers.get('content-type');\r\n      if (\r\n        response.status === 404 ||\r\n        (contentType != null && contentType.indexOf('javascript') === -1)\r\n      ) {\r\n        // No service worker found. Probably a different app. Reload the page.\r\n        navigator.serviceWorker.ready.then(registration => {\r\n          registration.unregister().then(() => {\r\n            window.location.reload();\r\n          });\r\n        });\r\n      } else {\r\n        // Service worker found. Proceed as normal.\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    })\r\n    .catch(() => {\r\n      console.log(\r\n        'No internet connection found. App is running in offline mode.'\r\n      );\r\n    });\r\n}\r\n\r\nexport function unregister() {\r\n  if ('serviceWorker' in navigator) {\r\n    navigator.serviceWorker.ready\r\n      .then(registration => {\r\n        registration.unregister();\r\n      })\r\n      .catch(error => {\r\n        console.error(error.message);\r\n      });\r\n  }\r\n}\r\n","import React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport { App } from \"./App\";\r\nimport { store } from \"./store/store\";\r\nimport { Provider } from \"react-redux\";\r\nimport * as serviceWorker from \"./serviceWorker\";\r\n\r\nReactDOM.render(\r\n  <Provider store={store}>\r\n    <App />\r\n  </Provider>,\r\n  document.getElementById('root')\r\n);\r\n\r\nserviceWorker.unregister();\r\n"],"sourceRoot":""}